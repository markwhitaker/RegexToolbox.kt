import org.junit.Assert.assertEquals
import org.junit.Assert.assertFalse
import org.junit.Assert.assertNotNull
import org.junit.Assert.assertNull
import org.junit.Assert.assertTrue
import org.junit.Test
import uk.co.mainwave.regextoolboxkotlin.RegexBuilder
import uk.co.mainwave.regextoolboxkotlin.RegexBuilderException
import uk.co.mainwave.regextoolboxkotlin.RegexOptions.IGNORE_CASE
import uk.co.mainwave.regextoolboxkotlin.RegexOptions.MULTILINE
import uk.co.mainwave.regextoolboxkotlin.RegexQuantifier
import uk.co.mainwave.regextoolboxkotlin.RegexQuantifier.AtLeast
import uk.co.mainwave.regextoolboxkotlin.RegexQuantifier.Between
import uk.co.mainwave.regextoolboxkotlin.RegexQuantifier.Exactly
import uk.co.mainwave.regextoolboxkotlin.RegexQuantifier.NoMoreThan
import uk.co.mainwave.regextoolboxkotlin.RegexQuantifier.OneOrMore
import uk.co.mainwave.regextoolboxkotlin.RegexQuantifier.ZeroOrMore
import uk.co.mainwave.regextoolboxkotlin.RegexQuantifier.ZeroOrOne
import java.util.regex.Pattern

class RegexBuilderTest {
    @Test
    fun testBuildPattern() {
        val pattern = RegexBuilder()
            .text("cat")
            .buildPattern(IGNORE_CASE, MULTILINE)

        assertEquals("cat", pattern.toString())
        assertEquals(Pattern.CASE_INSENSITIVE, pattern.flags() and Pattern.CASE_INSENSITIVE)
        assertEquals(Pattern.MULTILINE, pattern.flags() and Pattern.MULTILINE)
    }

    @Test
    fun testSimpleText() {
        val regex = RegexBuilder()
            .text("cat")
            .buildRegex()

        assertEquals("cat", regex.toString())
        assertTrue(regex.matches("cat"))
        assertTrue(regex.containsMatchIn("scatter"))
        assertFalse(regex.matches("Cat"))
        assertFalse(regex.matches("dog"))

        assertFalse(regex.containsMatchIn(BOTH_CASE_ALPHABET))
        assertFalse(regex.containsMatchIn(UPPER_CASE_ALPHABET))
        assertFalse(regex.containsMatchIn(LOWER_CASE_ALPHABET))
        assertFalse(regex.containsMatchIn(DECIMAL_DIGITS))
        assertFalse(regex.containsMatchIn(BOTH_CASE_HEX_DIGITS))
        assertFalse(regex.containsMatchIn(UPPER_CASE_HEX_DIGITS))
        assertFalse(regex.containsMatchIn(LOWER_CASE_HEX_DIGITS))
        assertFalse(regex.containsMatchIn(SYMBOLS))
        assertFalse(regex.containsMatchIn(WHITE_SPACE))
        assertFalse(regex.containsMatchIn(CONTROL_CHARACTERS))
        assertFalse(regex.containsMatchIn(EMPTY))
        assertFalse(regex.containsMatchIn(SIMPLE_NAME))
        assertFalse(regex.containsMatchIn(SIMPLE_EMAIL_ADDRESS))
        assertFalse(regex.containsMatchIn(SIMPLE_HTTP_URL))
        assertFalse(regex.containsMatchIn(SIMPLE_HTTPS_URL))
        assertFalse(regex.containsMatchIn(IPV4_ADDRESS))
        assertFalse(regex.containsMatchIn(IPV6_ADDRESS))
        assertFalse(regex.containsMatchIn(MAC_ADDRESS))
    }

    @Test
    fun testSimpleTextWithQuantifier() {
        val regex = RegexBuilder()
            .text("cat", Exactly(2))
            .buildRegex()

        assertEquals("(?:cat){2}", regex.toString())
        assertFalse(regex.containsMatchIn("cat"))
        assertTrue(regex.matches("catcat"))
        assertTrue(regex.containsMatchIn("catcatcat"))
        assertFalse(regex.containsMatchIn("scatter"))
        assertFalse(regex.containsMatchIn("Cat"))
        assertFalse(regex.containsMatchIn("dog"))

        assertFalse(regex.containsMatchIn(BOTH_CASE_ALPHABET))
        assertFalse(regex.containsMatchIn(UPPER_CASE_ALPHABET))
        assertFalse(regex.containsMatchIn(LOWER_CASE_ALPHABET))
        assertFalse(regex.containsMatchIn(DECIMAL_DIGITS))
        assertFalse(regex.containsMatchIn(BOTH_CASE_HEX_DIGITS))
        assertFalse(regex.containsMatchIn(UPPER_CASE_HEX_DIGITS))
        assertFalse(regex.containsMatchIn(LOWER_CASE_HEX_DIGITS))
        assertFalse(regex.containsMatchIn(SYMBOLS))
        assertFalse(regex.containsMatchIn(WHITE_SPACE))
        assertFalse(regex.containsMatchIn(CONTROL_CHARACTERS))
        assertFalse(regex.containsMatchIn(EMPTY))
        assertFalse(regex.containsMatchIn(SIMPLE_NAME))
        assertFalse(regex.containsMatchIn(SIMPLE_EMAIL_ADDRESS))
        assertFalse(regex.containsMatchIn(SIMPLE_HTTP_URL))
        assertFalse(regex.containsMatchIn(SIMPLE_HTTPS_URL))
        assertFalse(regex.containsMatchIn(IPV4_ADDRESS))
        assertFalse(regex.containsMatchIn(IPV6_ADDRESS))
        assertFalse(regex.containsMatchIn(MAC_ADDRESS))
    }

    @Test
    fun testSimpleTextCaseInsensitive() {
        val regex = RegexBuilder()
            .text("cat")
            .buildRegex(IGNORE_CASE)

        assertEquals("cat", regex.toString())
        assertTrue(regex.matches("cat"))
        assertTrue(regex.containsMatchIn("scatter"))
        assertTrue(regex.matches("Cat"))
        assertFalse(regex.containsMatchIn("dog"))

        assertFalse(regex.containsMatchIn(BOTH_CASE_ALPHABET))
        assertFalse(regex.containsMatchIn(UPPER_CASE_ALPHABET))
        assertFalse(regex.containsMatchIn(LOWER_CASE_ALPHABET))
        assertFalse(regex.containsMatchIn(DECIMAL_DIGITS))
        assertFalse(regex.containsMatchIn(BOTH_CASE_HEX_DIGITS))
        assertFalse(regex.containsMatchIn(UPPER_CASE_HEX_DIGITS))
        assertFalse(regex.containsMatchIn(LOWER_CASE_HEX_DIGITS))
        assertFalse(regex.containsMatchIn(SYMBOLS))
        assertFalse(regex.containsMatchIn(WHITE_SPACE))
        assertFalse(regex.containsMatchIn(CONTROL_CHARACTERS))
        assertFalse(regex.containsMatchIn(EMPTY))
        assertFalse(regex.containsMatchIn(SIMPLE_NAME))
        assertFalse(regex.containsMatchIn(SIMPLE_EMAIL_ADDRESS))
        assertFalse(regex.containsMatchIn(SIMPLE_HTTP_URL))
        assertFalse(regex.containsMatchIn(SIMPLE_HTTPS_URL))
        assertFalse(regex.containsMatchIn(IPV4_ADDRESS))
        assertFalse(regex.containsMatchIn(IPV6_ADDRESS))
        assertFalse(regex.containsMatchIn(MAC_ADDRESS))
    }

    @Test
    fun testSimpleTextWithRegexCharacters() {
        val regex = RegexBuilder()
            .text("\\.+*?[]{}()|^$")
            .buildRegex()

        assertEquals("\\\\\\.\\+\\*\\?\\[\\]\\{\\}\\(\\)\\|\\^\\$", regex.toString())
        assertTrue(regex.containsMatchIn("\\.+*?[]{}()|^$"))

        assertFalse(regex.containsMatchIn(BOTH_CASE_ALPHABET))
        assertFalse(regex.containsMatchIn(UPPER_CASE_ALPHABET))
        assertFalse(regex.containsMatchIn(LOWER_CASE_ALPHABET))
        assertFalse(regex.containsMatchIn(DECIMAL_DIGITS))
        assertFalse(regex.containsMatchIn(BOTH_CASE_HEX_DIGITS))
        assertFalse(regex.containsMatchIn(UPPER_CASE_HEX_DIGITS))
        assertFalse(regex.containsMatchIn(LOWER_CASE_HEX_DIGITS))
        assertFalse(regex.containsMatchIn(SYMBOLS))
        assertFalse(regex.containsMatchIn(WHITE_SPACE))
        assertFalse(regex.containsMatchIn(CONTROL_CHARACTERS))
        assertFalse(regex.containsMatchIn(EMPTY))
        assertFalse(regex.containsMatchIn(SIMPLE_NAME))
        assertFalse(regex.containsMatchIn(SIMPLE_EMAIL_ADDRESS))
        assertFalse(regex.containsMatchIn(SIMPLE_HTTP_URL))
        assertFalse(regex.containsMatchIn(SIMPLE_HTTPS_URL))
        assertFalse(regex.containsMatchIn(IPV4_ADDRESS))
        assertFalse(regex.containsMatchIn(IPV6_ADDRESS))
        assertFalse(regex.containsMatchIn(MAC_ADDRESS))
    }

    @Test
    fun testRegexText() {
        val regex = RegexBuilder()
            .regexText("^\\scat\\b")
            .buildRegex()

        assertEquals("^\\scat\\b", regex.toString())
        assertTrue(regex.containsMatchIn(" cat"))
        assertTrue(regex.containsMatchIn(" cat."))
        assertTrue(regex.containsMatchIn("\tcat "))
        assertTrue(regex.containsMatchIn(" cat-"))
        assertTrue(regex.containsMatchIn(" cat "))
        assertFalse(regex.containsMatchIn("cat"))
        assertFalse(regex.containsMatchIn(" catheter"))

        assertFalse(regex.containsMatchIn(BOTH_CASE_ALPHABET))
        assertFalse(regex.containsMatchIn(UPPER_CASE_ALPHABET))
        assertFalse(regex.containsMatchIn(LOWER_CASE_ALPHABET))
        assertFalse(regex.containsMatchIn(DECIMAL_DIGITS))
        assertFalse(regex.containsMatchIn(BOTH_CASE_HEX_DIGITS))
        assertFalse(regex.containsMatchIn(UPPER_CASE_HEX_DIGITS))
        assertFalse(regex.containsMatchIn(LOWER_CASE_HEX_DIGITS))
        assertFalse(regex.containsMatchIn(SYMBOLS))
        assertFalse(regex.containsMatchIn(WHITE_SPACE))
        assertFalse(regex.containsMatchIn(CONTROL_CHARACTERS))
        assertFalse(regex.containsMatchIn(EMPTY))
        assertFalse(regex.containsMatchIn(SIMPLE_NAME))
        assertFalse(regex.containsMatchIn(SIMPLE_EMAIL_ADDRESS))
        assertFalse(regex.containsMatchIn(SIMPLE_HTTP_URL))
        assertFalse(regex.containsMatchIn(SIMPLE_HTTPS_URL))
        assertFalse(regex.containsMatchIn(IPV4_ADDRESS))
        assertFalse(regex.containsMatchIn(IPV6_ADDRESS))
        assertFalse(regex.containsMatchIn(MAC_ADDRESS))
    }

    @Test
    fun testAnyCharacter() {
        val regex = RegexBuilder()
            .anyCharacter()
            .buildRegex()

        assertEquals(".", regex.toString())
        assertTrue(regex.containsMatchIn(" "))
        assertTrue(regex.containsMatchIn("a"))
        assertTrue(regex.containsMatchIn("1"))
        assertTrue(regex.containsMatchIn("\\"))
        assertFalse(regex.containsMatchIn(""))
        assertFalse(regex.containsMatchIn("\n"))

        assertTrue(regex.containsMatchIn(BOTH_CASE_ALPHABET))
        assertTrue(regex.containsMatchIn(UPPER_CASE_ALPHABET))
        assertTrue(regex.containsMatchIn(LOWER_CASE_ALPHABET))
        assertTrue(regex.containsMatchIn(DECIMAL_DIGITS))
        assertTrue(regex.containsMatchIn(BOTH_CASE_HEX_DIGITS))
        assertTrue(regex.containsMatchIn(UPPER_CASE_HEX_DIGITS))
        assertTrue(regex.containsMatchIn(LOWER_CASE_HEX_DIGITS))
        assertTrue(regex.containsMatchIn(SYMBOLS))
        assertTrue(regex.containsMatchIn(WHITE_SPACE))
        assertTrue(regex.containsMatchIn(CONTROL_CHARACTERS))
        assertFalse(regex.containsMatchIn(EMPTY))
        assertTrue(regex.containsMatchIn(SIMPLE_NAME))
        assertTrue(regex.containsMatchIn(SIMPLE_EMAIL_ADDRESS))
        assertTrue(regex.containsMatchIn(SIMPLE_HTTP_URL))
        assertTrue(regex.containsMatchIn(SIMPLE_HTTPS_URL))
        assertTrue(regex.containsMatchIn(IPV4_ADDRESS))
        assertTrue(regex.containsMatchIn(IPV6_ADDRESS))
        assertTrue(regex.containsMatchIn(MAC_ADDRESS))
    }

    @Test
    fun testWhitespace() {
        val regex = RegexBuilder()
            .whitespace()
            .buildRegex()

        assertEquals("\\s", regex.toString())
        assertTrue(regex.containsMatchIn(" "))
        assertTrue(regex.containsMatchIn("\t"))
        assertTrue(regex.containsMatchIn("\r"))
        assertTrue(regex.containsMatchIn("\n"))
        assertTrue(regex.containsMatchIn("\r\n"))
        assertTrue(regex.containsMatchIn("\t \t"))
        assertTrue(regex.containsMatchIn("                hi!"))
        assertFalse(regex.containsMatchIn("cat"))

        assertFalse(regex.containsMatchIn(BOTH_CASE_ALPHABET))
        assertFalse(regex.containsMatchIn(UPPER_CASE_ALPHABET))
        assertFalse(regex.containsMatchIn(LOWER_CASE_ALPHABET))
        assertFalse(regex.containsMatchIn(DECIMAL_DIGITS))
        assertFalse(regex.containsMatchIn(BOTH_CASE_HEX_DIGITS))
        assertFalse(regex.containsMatchIn(UPPER_CASE_HEX_DIGITS))
        assertFalse(regex.containsMatchIn(LOWER_CASE_HEX_DIGITS))
        assertFalse(regex.containsMatchIn(SYMBOLS))
        assertTrue(regex.containsMatchIn(WHITE_SPACE))
        assertFalse(regex.containsMatchIn(CONTROL_CHARACTERS))
        assertFalse(regex.containsMatchIn(EMPTY))
        assertTrue(regex.containsMatchIn(SIMPLE_NAME))
        assertFalse(regex.containsMatchIn(SIMPLE_EMAIL_ADDRESS))
        assertFalse(regex.containsMatchIn(SIMPLE_HTTP_URL))
        assertFalse(regex.containsMatchIn(SIMPLE_HTTPS_URL))
        assertFalse(regex.containsMatchIn(IPV4_ADDRESS))
        assertFalse(regex.containsMatchIn(IPV6_ADDRESS))
        assertFalse(regex.containsMatchIn(MAC_ADDRESS))
    }

    @Test
    fun testNonWhitespace() {
        val regex = RegexBuilder()
            .nonWhitespace()
            .buildRegex()

        assertEquals("\\S", regex.toString())
        assertTrue(regex.containsMatchIn("a"))
        assertTrue(regex.containsMatchIn("1"))
        assertTrue(regex.containsMatchIn("-"))
        assertTrue(regex.containsMatchIn("*"))
        assertTrue(regex.containsMatchIn("abc"))
        assertTrue(regex.containsMatchIn("                hi!"))
        assertFalse(regex.containsMatchIn(" "))
        assertFalse(regex.containsMatchIn("\t"))
        assertFalse(regex.containsMatchIn("\r"))
        assertFalse(regex.containsMatchIn("\n"))
        assertFalse(regex.containsMatchIn("\t\t\r\n   "))

        assertTrue(regex.containsMatchIn(BOTH_CASE_ALPHABET))
        assertTrue(regex.containsMatchIn(UPPER_CASE_ALPHABET))
        assertTrue(regex.containsMatchIn(LOWER_CASE_ALPHABET))
        assertTrue(regex.containsMatchIn(DECIMAL_DIGITS))
        assertTrue(regex.containsMatchIn(BOTH_CASE_HEX_DIGITS))
        assertTrue(regex.containsMatchIn(UPPER_CASE_HEX_DIGITS))
        assertTrue(regex.containsMatchIn(LOWER_CASE_HEX_DIGITS))
        assertTrue(regex.containsMatchIn(SYMBOLS))
        assertFalse(regex.containsMatchIn(WHITE_SPACE))
        assertTrue(regex.containsMatchIn(CONTROL_CHARACTERS))
        assertFalse(regex.containsMatchIn(EMPTY))
        assertTrue(regex.containsMatchIn(SIMPLE_NAME))
        assertTrue(regex.containsMatchIn(SIMPLE_EMAIL_ADDRESS))
        assertTrue(regex.containsMatchIn(SIMPLE_HTTP_URL))
        assertTrue(regex.containsMatchIn(SIMPLE_HTTPS_URL))
        assertTrue(regex.containsMatchIn(IPV4_ADDRESS))
        assertTrue(regex.containsMatchIn(IPV6_ADDRESS))
        assertTrue(regex.containsMatchIn(MAC_ADDRESS))
    }

    @Test
    fun testPossibleWhitespace() {
        val regex = RegexBuilder()
            .nonWhitespace()
            .possibleWhitespace()
            .nonWhitespace()
            .buildRegex()

        assertEquals("\\S\\s*\\S", regex.toString())
        assertFalse(regex.containsMatchIn("1"))
        assertFalse(regex.containsMatchIn("0"))
        assertTrue(regex.containsMatchIn("999"))
        assertTrue(regex.containsMatchIn("there's a digit in here s0mewhere"))
        assertFalse(regex.containsMatchIn(" "))
        assertTrue(regex.containsMatchIn("abc"))
        assertTrue(regex.containsMatchIn("xFFF"))

        assertTrue(regex.containsMatchIn(BOTH_CASE_ALPHABET))
        assertTrue(regex.containsMatchIn(UPPER_CASE_ALPHABET))
        assertTrue(regex.containsMatchIn(LOWER_CASE_ALPHABET))
        assertTrue(regex.containsMatchIn(DECIMAL_DIGITS))
        assertTrue(regex.containsMatchIn(BOTH_CASE_HEX_DIGITS))
        assertTrue(regex.containsMatchIn(UPPER_CASE_HEX_DIGITS))
        assertTrue(regex.containsMatchIn(LOWER_CASE_HEX_DIGITS))
        assertTrue(regex.containsMatchIn(SYMBOLS))
        assertFalse(regex.containsMatchIn(WHITE_SPACE))
        assertFalse(regex.containsMatchIn(CONTROL_CHARACTERS))
        assertFalse(regex.containsMatchIn(EMPTY))
        assertTrue(regex.containsMatchIn(SIMPLE_NAME))
        assertTrue(regex.containsMatchIn(SIMPLE_EMAIL_ADDRESS))
        assertTrue(regex.containsMatchIn(SIMPLE_HTTP_URL))
        assertTrue(regex.containsMatchIn(SIMPLE_HTTPS_URL))
        assertTrue(regex.containsMatchIn(IPV4_ADDRESS))
        assertTrue(regex.containsMatchIn(IPV6_ADDRESS))
        assertTrue(regex.containsMatchIn(MAC_ADDRESS))
    }

    @Test
    fun testSpace() {
        val regex = RegexBuilder()
            .space()
            .buildRegex()

        assertEquals(" ", regex.toString())
        assertTrue(regex.containsMatchIn(" "))
        assertFalse(regex.containsMatchIn("\t"))
        assertFalse(regex.containsMatchIn("\r"))
        assertFalse(regex.containsMatchIn("\n"))
        assertFalse(regex.containsMatchIn("\r\n"))
        assertTrue(regex.containsMatchIn("\t \t"))
        assertTrue(regex.containsMatchIn("                hi!"))
        assertFalse(regex.containsMatchIn("cat"))

        assertFalse(regex.containsMatchIn(BOTH_CASE_ALPHABET))
        assertFalse(regex.containsMatchIn(UPPER_CASE_ALPHABET))
        assertFalse(regex.containsMatchIn(LOWER_CASE_ALPHABET))
        assertFalse(regex.containsMatchIn(DECIMAL_DIGITS))
        assertFalse(regex.containsMatchIn(BOTH_CASE_HEX_DIGITS))
        assertFalse(regex.containsMatchIn(UPPER_CASE_HEX_DIGITS))
        assertFalse(regex.containsMatchIn(LOWER_CASE_HEX_DIGITS))
        assertFalse(regex.containsMatchIn(SYMBOLS))
        assertTrue(regex.containsMatchIn(WHITE_SPACE))
        assertFalse(regex.containsMatchIn(CONTROL_CHARACTERS))
        assertFalse(regex.containsMatchIn(EMPTY))
        assertTrue(regex.containsMatchIn(SIMPLE_NAME))
        assertFalse(regex.containsMatchIn(SIMPLE_EMAIL_ADDRESS))
        assertFalse(regex.containsMatchIn(SIMPLE_HTTP_URL))
        assertFalse(regex.containsMatchIn(SIMPLE_HTTPS_URL))
        assertFalse(regex.containsMatchIn(IPV4_ADDRESS))
        assertFalse(regex.containsMatchIn(IPV6_ADDRESS))
        assertFalse(regex.containsMatchIn(MAC_ADDRESS))
    }

    @Test
    fun testTab() {
        val regex = RegexBuilder()
            .tab()
            .buildRegex()

        assertEquals("\\t", regex.toString())
        assertFalse(regex.containsMatchIn(" "))
        assertTrue(regex.containsMatchIn("\t"))
        assertFalse(regex.containsMatchIn("\r"))
        assertFalse(regex.containsMatchIn("\n"))
        assertFalse(regex.containsMatchIn("\r\n"))
        assertTrue(regex.containsMatchIn("\t \t"))
        assertFalse(regex.containsMatchIn("                hi!"))
        assertFalse(regex.containsMatchIn("cat"))

        assertFalse(regex.containsMatchIn(BOTH_CASE_ALPHABET))
        assertFalse(regex.containsMatchIn(UPPER_CASE_ALPHABET))
        assertFalse(regex.containsMatchIn(LOWER_CASE_ALPHABET))
        assertFalse(regex.containsMatchIn(DECIMAL_DIGITS))
        assertFalse(regex.containsMatchIn(BOTH_CASE_HEX_DIGITS))
        assertFalse(regex.containsMatchIn(UPPER_CASE_HEX_DIGITS))
        assertFalse(regex.containsMatchIn(LOWER_CASE_HEX_DIGITS))
        assertFalse(regex.containsMatchIn(SYMBOLS))
        assertTrue(regex.containsMatchIn(WHITE_SPACE))
        assertFalse(regex.containsMatchIn(CONTROL_CHARACTERS))
        assertFalse(regex.containsMatchIn(EMPTY))
        assertFalse(regex.containsMatchIn(SIMPLE_NAME))
        assertFalse(regex.containsMatchIn(SIMPLE_EMAIL_ADDRESS))
        assertFalse(regex.containsMatchIn(SIMPLE_HTTP_URL))
        assertFalse(regex.containsMatchIn(SIMPLE_HTTPS_URL))
        assertFalse(regex.containsMatchIn(IPV4_ADDRESS))
        assertFalse(regex.containsMatchIn(IPV6_ADDRESS))
        assertFalse(regex.containsMatchIn(MAC_ADDRESS))
    }

    @Test
    fun testLineFeed() {
        val regex = RegexBuilder()
            .lineFeed()
            .buildRegex()

        assertEquals("\\n", regex.toString())
        assertFalse(regex.containsMatchIn(" "))
        assertFalse(regex.containsMatchIn("\t"))
        assertFalse(regex.containsMatchIn("\r"))
        assertTrue(regex.containsMatchIn("\n"))
        assertTrue(regex.containsMatchIn("\r\n"))
        assertFalse(regex.containsMatchIn("\t \t"))
        assertFalse(regex.containsMatchIn("                hi!"))
        assertFalse(regex.containsMatchIn("cat"))

        assertFalse(regex.containsMatchIn(BOTH_CASE_ALPHABET))
        assertFalse(regex.containsMatchIn(UPPER_CASE_ALPHABET))
        assertFalse(regex.containsMatchIn(LOWER_CASE_ALPHABET))
        assertFalse(regex.containsMatchIn(DECIMAL_DIGITS))
        assertFalse(regex.containsMatchIn(BOTH_CASE_HEX_DIGITS))
        assertFalse(regex.containsMatchIn(UPPER_CASE_HEX_DIGITS))
        assertFalse(regex.containsMatchIn(LOWER_CASE_HEX_DIGITS))
        assertFalse(regex.containsMatchIn(SYMBOLS))
        assertTrue(regex.containsMatchIn(WHITE_SPACE))
        assertFalse(regex.containsMatchIn(CONTROL_CHARACTERS))
        assertFalse(regex.containsMatchIn(EMPTY))
        assertFalse(regex.containsMatchIn(SIMPLE_NAME))
        assertFalse(regex.containsMatchIn(SIMPLE_EMAIL_ADDRESS))
        assertFalse(regex.containsMatchIn(SIMPLE_HTTP_URL))
        assertFalse(regex.containsMatchIn(SIMPLE_HTTPS_URL))
        assertFalse(regex.containsMatchIn(IPV4_ADDRESS))
        assertFalse(regex.containsMatchIn(IPV6_ADDRESS))
        assertFalse(regex.containsMatchIn(MAC_ADDRESS))
    }

    @Test
    fun testCarriageReturn() {
        val regex = RegexBuilder()
            .carriageReturn()
            .buildRegex()

        assertEquals("\\r", regex.toString())
        assertFalse(regex.containsMatchIn(" "))
        assertFalse(regex.containsMatchIn("\t"))
        assertTrue(regex.containsMatchIn("\r"))
        assertFalse(regex.containsMatchIn("\n"))
        assertTrue(regex.containsMatchIn("\r\n"))
        assertFalse(regex.containsMatchIn("\t \t"))
        assertFalse(regex.containsMatchIn("                hi!"))
        assertFalse(regex.containsMatchIn("cat"))

        assertFalse(regex.containsMatchIn(BOTH_CASE_ALPHABET))
        assertFalse(regex.containsMatchIn(UPPER_CASE_ALPHABET))
        assertFalse(regex.containsMatchIn(LOWER_CASE_ALPHABET))
        assertFalse(regex.containsMatchIn(DECIMAL_DIGITS))
        assertFalse(regex.containsMatchIn(BOTH_CASE_HEX_DIGITS))
        assertFalse(regex.containsMatchIn(UPPER_CASE_HEX_DIGITS))
        assertFalse(regex.containsMatchIn(LOWER_CASE_HEX_DIGITS))
        assertFalse(regex.containsMatchIn(SYMBOLS))
        assertTrue(regex.containsMatchIn(WHITE_SPACE))
        assertFalse(regex.containsMatchIn(CONTROL_CHARACTERS))
        assertFalse(regex.containsMatchIn(EMPTY))
        assertFalse(regex.containsMatchIn(SIMPLE_NAME))
        assertFalse(regex.containsMatchIn(SIMPLE_EMAIL_ADDRESS))
        assertFalse(regex.containsMatchIn(SIMPLE_HTTP_URL))
        assertFalse(regex.containsMatchIn(SIMPLE_HTTPS_URL))
        assertFalse(regex.containsMatchIn(IPV4_ADDRESS))
        assertFalse(regex.containsMatchIn(IPV6_ADDRESS))
        assertFalse(regex.containsMatchIn(MAC_ADDRESS))
    }

    @Test
    fun testDigit() {
        val regex = RegexBuilder()
            .digit()
            .buildRegex()

        assertEquals("\\d", regex.toString())
        assertTrue(regex.containsMatchIn("1"))
        assertTrue(regex.containsMatchIn("0"))
        assertTrue(regex.containsMatchIn("999"))
        assertTrue(regex.containsMatchIn("there's a digit in here s0mewhere"))
        assertFalse(regex.containsMatchIn(" "))
        assertFalse(regex.containsMatchIn("abc"))
        assertFalse(regex.containsMatchIn("xFFF"))

        assertFalse(regex.containsMatchIn(BOTH_CASE_ALPHABET))
        assertFalse(regex.containsMatchIn(UPPER_CASE_ALPHABET))
        assertFalse(regex.containsMatchIn(LOWER_CASE_ALPHABET))
        assertTrue(regex.containsMatchIn(DECIMAL_DIGITS))
        assertTrue(regex.containsMatchIn(BOTH_CASE_HEX_DIGITS))
        assertTrue(regex.containsMatchIn(UPPER_CASE_HEX_DIGITS))
        assertTrue(regex.containsMatchIn(LOWER_CASE_HEX_DIGITS))
        assertFalse(regex.containsMatchIn(SYMBOLS))
        assertFalse(regex.containsMatchIn(WHITE_SPACE))
        assertFalse(regex.containsMatchIn(CONTROL_CHARACTERS))
        assertFalse(regex.containsMatchIn(EMPTY))
        assertFalse(regex.containsMatchIn(SIMPLE_NAME))
        assertFalse(regex.containsMatchIn(SIMPLE_EMAIL_ADDRESS))
        assertFalse(regex.containsMatchIn(SIMPLE_HTTP_URL))
        assertFalse(regex.containsMatchIn(SIMPLE_HTTPS_URL))
        assertTrue(regex.containsMatchIn(IPV4_ADDRESS))
        assertTrue(regex.containsMatchIn(IPV6_ADDRESS))
        assertTrue(regex.containsMatchIn(MAC_ADDRESS))
    }

    @Test
    fun testNonDigit() {
        val regex = RegexBuilder()
            .nonDigit()
            .buildRegex()

        assertEquals("\\D", regex.toString())
        assertTrue(regex.containsMatchIn(" 1"))
        assertTrue(regex.containsMatchIn("a0"))
        assertTrue(regex.containsMatchIn("999_"))
        assertTrue(regex.containsMatchIn("1,000"))
        assertTrue(regex.containsMatchIn("there's a digit in here s0mewhere"))
        assertFalse(regex.containsMatchIn("1"))
        assertFalse(regex.containsMatchIn("0"))
        assertFalse(regex.containsMatchIn("999"))

        assertTrue(regex.containsMatchIn(BOTH_CASE_ALPHABET))
        assertTrue(regex.containsMatchIn(UPPER_CASE_ALPHABET))
        assertTrue(regex.containsMatchIn(LOWER_CASE_ALPHABET))
        assertFalse(regex.containsMatchIn(DECIMAL_DIGITS))
        assertTrue(regex.containsMatchIn(BOTH_CASE_HEX_DIGITS))
        assertTrue(regex.containsMatchIn(UPPER_CASE_HEX_DIGITS))
        assertTrue(regex.containsMatchIn(LOWER_CASE_HEX_DIGITS))
        assertTrue(regex.containsMatchIn(SYMBOLS))
        assertTrue(regex.containsMatchIn(WHITE_SPACE))
        assertTrue(regex.containsMatchIn(CONTROL_CHARACTERS))
        assertFalse(regex.containsMatchIn(EMPTY))
        assertTrue(regex.containsMatchIn(SIMPLE_NAME))
        assertTrue(regex.containsMatchIn(SIMPLE_EMAIL_ADDRESS))
        assertTrue(regex.containsMatchIn(SIMPLE_HTTP_URL))
        assertTrue(regex.containsMatchIn(SIMPLE_HTTPS_URL))
        assertTrue(regex.containsMatchIn(IPV4_ADDRESS))
        assertTrue(regex.containsMatchIn(IPV6_ADDRESS))
        assertTrue(regex.containsMatchIn(MAC_ADDRESS))
    }

    @Test
    fun testLetter() {
        val regex = RegexBuilder()
            .letter()
            .buildRegex()

        assertEquals("[a-zA-Z]", regex.toString())
        assertTrue(regex.containsMatchIn("a"))
        assertTrue(regex.containsMatchIn("A"))
        assertTrue(regex.containsMatchIn("        z"))
        assertTrue(regex.containsMatchIn("text with spaces"))
        assertFalse(regex.containsMatchIn(" "))
        assertFalse(regex.containsMatchIn("1"))
        assertFalse(regex.containsMatchIn("%"))
        assertFalse(regex.containsMatchIn(""))

        assertTrue(regex.containsMatchIn(BOTH_CASE_ALPHABET))
        assertTrue(regex.containsMatchIn(UPPER_CASE_ALPHABET))
        assertTrue(regex.containsMatchIn(LOWER_CASE_ALPHABET))
        assertFalse(regex.containsMatchIn(DECIMAL_DIGITS))
        assertTrue(regex.containsMatchIn(BOTH_CASE_HEX_DIGITS))
        assertTrue(regex.containsMatchIn(UPPER_CASE_HEX_DIGITS))
        assertTrue(regex.containsMatchIn(LOWER_CASE_HEX_DIGITS))
        assertFalse(regex.containsMatchIn(SYMBOLS))
        assertFalse(regex.containsMatchIn(WHITE_SPACE))
        assertFalse(regex.containsMatchIn(CONTROL_CHARACTERS))
        assertFalse(regex.containsMatchIn(EMPTY))
        assertTrue(regex.containsMatchIn(SIMPLE_NAME))
        assertTrue(regex.containsMatchIn(SIMPLE_EMAIL_ADDRESS))
        assertTrue(regex.containsMatchIn(SIMPLE_HTTP_URL))
        assertTrue(regex.containsMatchIn(SIMPLE_HTTPS_URL))
        assertFalse(regex.containsMatchIn(IPV4_ADDRESS))
        assertTrue(regex.containsMatchIn(IPV6_ADDRESS))
        assertTrue(regex.containsMatchIn(MAC_ADDRESS))
    }

    @Test
    fun testNonLetter() {
        val regex = RegexBuilder()
            .nonLetter()
            .buildRegex()

        assertEquals("[^a-zA-Z]", regex.toString())
        assertTrue(regex.containsMatchIn(" 1"))
        assertTrue(regex.containsMatchIn("0"))
        assertTrue(regex.containsMatchIn("999_"))
        assertTrue(regex.containsMatchIn("1,000"))
        assertTrue(regex.containsMatchIn("text with spaces"))
        assertFalse(regex.containsMatchIn("a"))
        assertFalse(regex.containsMatchIn("ZZZ"))
        assertFalse(regex.containsMatchIn(""))

        assertFalse(regex.containsMatchIn(BOTH_CASE_ALPHABET))
        assertFalse(regex.containsMatchIn(UPPER_CASE_ALPHABET))
        assertFalse(regex.containsMatchIn(LOWER_CASE_ALPHABET))
        assertTrue(regex.containsMatchIn(DECIMAL_DIGITS))
        assertTrue(regex.containsMatchIn(BOTH_CASE_HEX_DIGITS))
        assertTrue(regex.containsMatchIn(UPPER_CASE_HEX_DIGITS))
        assertTrue(regex.containsMatchIn(LOWER_CASE_HEX_DIGITS))
        assertTrue(regex.containsMatchIn(SYMBOLS))
        assertTrue(regex.containsMatchIn(WHITE_SPACE))
        assertTrue(regex.containsMatchIn(CONTROL_CHARACTERS))
        assertFalse(regex.containsMatchIn(EMPTY))
        assertTrue(regex.containsMatchIn(SIMPLE_NAME))
        assertTrue(regex.containsMatchIn(SIMPLE_EMAIL_ADDRESS))
        assertTrue(regex.containsMatchIn(SIMPLE_HTTP_URL))
        assertTrue(regex.containsMatchIn(SIMPLE_HTTPS_URL))
        assertTrue(regex.containsMatchIn(IPV4_ADDRESS))
        assertTrue(regex.containsMatchIn(IPV6_ADDRESS))
        assertTrue(regex.containsMatchIn(MAC_ADDRESS))
    }

    @Test
    fun testUppercaseLetter() {
        val regex = RegexBuilder()
            .uppercaseLetter()
            .buildRegex()

        assertEquals("[A-Z]", regex.toString())
        assertTrue(regex.containsMatchIn("A"))
        assertTrue(regex.containsMatchIn("        Z"))
        assertTrue(regex.containsMatchIn("text with Spaces"))
        assertFalse(regex.containsMatchIn(" "))
        assertFalse(regex.containsMatchIn("1"))
        assertFalse(regex.containsMatchIn("%"))
        assertFalse(regex.containsMatchIn("s"))
        assertFalse(regex.containsMatchIn(""))

        assertTrue(regex.containsMatchIn(BOTH_CASE_ALPHABET))
        assertTrue(regex.containsMatchIn(UPPER_CASE_ALPHABET))
        assertFalse(regex.containsMatchIn(LOWER_CASE_ALPHABET))
        assertFalse(regex.containsMatchIn(DECIMAL_DIGITS))
        assertTrue(regex.containsMatchIn(BOTH_CASE_HEX_DIGITS))
        assertTrue(regex.containsMatchIn(UPPER_CASE_HEX_DIGITS))
        assertFalse(regex.containsMatchIn(LOWER_CASE_HEX_DIGITS))
        assertFalse(regex.containsMatchIn(SYMBOLS))
        assertFalse(regex.containsMatchIn(WHITE_SPACE))
        assertFalse(regex.containsMatchIn(CONTROL_CHARACTERS))
        assertFalse(regex.containsMatchIn(EMPTY))
        assertTrue(regex.containsMatchIn(SIMPLE_NAME))
        assertFalse(regex.containsMatchIn(SIMPLE_EMAIL_ADDRESS))
        assertFalse(regex.containsMatchIn(SIMPLE_HTTP_URL))
        assertFalse(regex.containsMatchIn(SIMPLE_HTTPS_URL))
        assertFalse(regex.containsMatchIn(IPV4_ADDRESS))
        assertFalse(regex.containsMatchIn(IPV6_ADDRESS))
        assertFalse(regex.containsMatchIn(MAC_ADDRESS))
    }

    @Test
    fun testLowercaseLetter() {
        val regex = RegexBuilder()
            .lowercaseLetter()
            .buildRegex()

        assertEquals("[a-z]", regex.toString())
        assertTrue(regex.containsMatchIn("a"))
        assertTrue(regex.containsMatchIn("        z"))
        assertTrue(regex.containsMatchIn("text with Spaces"))
        assertFalse(regex.containsMatchIn(" "))
        assertFalse(regex.containsMatchIn("1"))
        assertFalse(regex.containsMatchIn("%"))
        assertFalse(regex.containsMatchIn("S"))
        assertFalse(regex.containsMatchIn(""))

        assertTrue(regex.containsMatchIn(BOTH_CASE_ALPHABET))
        assertFalse(regex.containsMatchIn(UPPER_CASE_ALPHABET))
        assertTrue(regex.containsMatchIn(LOWER_CASE_ALPHABET))
        assertFalse(regex.containsMatchIn(DECIMAL_DIGITS))
        assertTrue(regex.containsMatchIn(BOTH_CASE_HEX_DIGITS))
        assertFalse(regex.containsMatchIn(UPPER_CASE_HEX_DIGITS))
        assertTrue(regex.containsMatchIn(LOWER_CASE_HEX_DIGITS))
        assertFalse(regex.containsMatchIn(SYMBOLS))
        assertFalse(regex.containsMatchIn(WHITE_SPACE))
        assertFalse(regex.containsMatchIn(CONTROL_CHARACTERS))
        assertFalse(regex.containsMatchIn(EMPTY))
        assertTrue(regex.containsMatchIn(SIMPLE_NAME))
        assertTrue(regex.containsMatchIn(SIMPLE_EMAIL_ADDRESS))
        assertTrue(regex.containsMatchIn(SIMPLE_HTTP_URL))
        assertTrue(regex.containsMatchIn(SIMPLE_HTTPS_URL))
        assertFalse(regex.containsMatchIn(IPV4_ADDRESS))
        assertTrue(regex.containsMatchIn(IPV6_ADDRESS))
        assertTrue(regex.containsMatchIn(MAC_ADDRESS))
    }

    @Test
    fun testLetterOrDigit() {
        val regex = RegexBuilder()
            .letterOrDigit()
            .buildRegex()

        assertEquals("[a-zA-Z0-9]", regex.toString())
        assertTrue(regex.containsMatchIn("A"))
        assertTrue(regex.containsMatchIn("        Z"))
        assertTrue(regex.containsMatchIn("text with Spaces"))
        assertFalse(regex.containsMatchIn(" "))
        assertTrue(regex.containsMatchIn("1"))
        assertFalse(regex.containsMatchIn("%"))
        assertFalse(regex.containsMatchIn("_"))
        assertTrue(regex.containsMatchIn("s"))
        assertFalse(regex.containsMatchIn(""))

        assertTrue(regex.containsMatchIn(BOTH_CASE_ALPHABET))
        assertTrue(regex.containsMatchIn(UPPER_CASE_ALPHABET))
        assertTrue(regex.containsMatchIn(LOWER_CASE_ALPHABET))
        assertTrue(regex.containsMatchIn(DECIMAL_DIGITS))
        assertTrue(regex.containsMatchIn(BOTH_CASE_HEX_DIGITS))
        assertTrue(regex.containsMatchIn(UPPER_CASE_HEX_DIGITS))
        assertTrue(regex.containsMatchIn(LOWER_CASE_HEX_DIGITS))
        assertFalse(regex.containsMatchIn(SYMBOLS))
        assertFalse(regex.containsMatchIn(WHITE_SPACE))
        assertFalse(regex.containsMatchIn(CONTROL_CHARACTERS))
        assertFalse(regex.containsMatchIn(EMPTY))
        assertTrue(regex.containsMatchIn(SIMPLE_NAME))
        assertTrue(regex.containsMatchIn(SIMPLE_EMAIL_ADDRESS))
        assertTrue(regex.containsMatchIn(SIMPLE_HTTP_URL))
        assertTrue(regex.containsMatchIn(SIMPLE_HTTPS_URL))
        assertTrue(regex.containsMatchIn(IPV4_ADDRESS))
        assertTrue(regex.containsMatchIn(IPV6_ADDRESS))
        assertTrue(regex.containsMatchIn(MAC_ADDRESS))
    }

    @Test
    fun testNonLetterOrDigit() {
        val regex = RegexBuilder()
            .nonLetterOrDigit()
            .buildRegex()

        assertEquals("[^a-zA-Z0-9]", regex.toString())
        assertFalse(regex.containsMatchIn("A"))
        assertTrue(regex.containsMatchIn("        Z"))
        assertTrue(regex.containsMatchIn("text with Spaces"))
        assertTrue(regex.containsMatchIn(" "))
        assertFalse(regex.containsMatchIn("1"))
        assertTrue(regex.containsMatchIn("%"))
        assertTrue(regex.containsMatchIn("_"))
        assertFalse(regex.containsMatchIn("s"))
        assertFalse(regex.containsMatchIn(""))

        assertFalse(regex.containsMatchIn(BOTH_CASE_ALPHABET))
        assertFalse(regex.containsMatchIn(UPPER_CASE_ALPHABET))
        assertFalse(regex.containsMatchIn(LOWER_CASE_ALPHABET))
        assertFalse(regex.containsMatchIn(DECIMAL_DIGITS))
        assertFalse(regex.containsMatchIn(BOTH_CASE_HEX_DIGITS))
        assertFalse(regex.containsMatchIn(UPPER_CASE_HEX_DIGITS))
        assertFalse(regex.containsMatchIn(LOWER_CASE_HEX_DIGITS))
        assertTrue(regex.containsMatchIn(SYMBOLS))
        assertTrue(regex.containsMatchIn(WHITE_SPACE))
        assertTrue(regex.containsMatchIn(CONTROL_CHARACTERS))
        assertFalse(regex.containsMatchIn(EMPTY))
        assertTrue(regex.containsMatchIn(SIMPLE_NAME))
        assertTrue(regex.containsMatchIn(SIMPLE_EMAIL_ADDRESS))
        assertTrue(regex.containsMatchIn(SIMPLE_HTTP_URL))
        assertTrue(regex.containsMatchIn(SIMPLE_HTTPS_URL))
        assertTrue(regex.containsMatchIn(IPV4_ADDRESS))
        assertTrue(regex.containsMatchIn(IPV6_ADDRESS))
        assertTrue(regex.containsMatchIn(MAC_ADDRESS))
    }

    @Test
    fun testHexDigit() {
        val regex = RegexBuilder()
            .hexDigit()
            .buildRegex()

        assertEquals("[0-9A-Fa-f]", regex.toString())
        assertTrue(regex.containsMatchIn("A"))
        assertTrue(regex.containsMatchIn("        f"))
        assertTrue(regex.containsMatchIn("text with Spaces"))
        assertFalse(regex.containsMatchIn(" "))
        assertTrue(regex.containsMatchIn("1"))
        assertFalse(regex.containsMatchIn("%"))
        assertFalse(regex.containsMatchIn("_"))
        assertFalse(regex.containsMatchIn("s"))
        assertFalse(regex.containsMatchIn(""))

        assertTrue(regex.containsMatchIn(BOTH_CASE_ALPHABET))
        assertTrue(regex.containsMatchIn(UPPER_CASE_ALPHABET))
        assertTrue(regex.containsMatchIn(LOWER_CASE_ALPHABET))
        assertTrue(regex.containsMatchIn(DECIMAL_DIGITS))
        assertTrue(regex.containsMatchIn(BOTH_CASE_HEX_DIGITS))
        assertTrue(regex.containsMatchIn(UPPER_CASE_HEX_DIGITS))
        assertTrue(regex.containsMatchIn(LOWER_CASE_HEX_DIGITS))
        assertFalse(regex.containsMatchIn(SYMBOLS))
        assertFalse(regex.containsMatchIn(WHITE_SPACE))
        assertFalse(regex.containsMatchIn(CONTROL_CHARACTERS))
        assertFalse(regex.containsMatchIn(EMPTY))
        assertFalse(regex.containsMatchIn(SIMPLE_NAME))
        assertTrue(regex.containsMatchIn(SIMPLE_EMAIL_ADDRESS))
        assertTrue(regex.containsMatchIn(SIMPLE_HTTP_URL))
        assertTrue(regex.containsMatchIn(SIMPLE_HTTPS_URL))
        assertTrue(regex.containsMatchIn(IPV4_ADDRESS))
        assertTrue(regex.containsMatchIn(IPV6_ADDRESS))
        assertTrue(regex.containsMatchIn(MAC_ADDRESS))
    }

    @Test
    fun testUppercaseHexDigit() {
        val regex = RegexBuilder()
            .uppercaseHexDigit()
            .buildRegex()

        assertEquals("[0-9A-F]", regex.toString())
        assertTrue(regex.containsMatchIn("A"))
        assertFalse(regex.containsMatchIn("        f"))
        assertFalse(regex.containsMatchIn("text with Spaces"))
        assertFalse(regex.containsMatchIn(" "))
        assertTrue(regex.containsMatchIn("1"))
        assertFalse(regex.containsMatchIn("%"))
        assertFalse(regex.containsMatchIn("_"))
        assertFalse(regex.containsMatchIn("s"))
        assertFalse(regex.containsMatchIn(""))

        assertTrue(regex.containsMatchIn(BOTH_CASE_ALPHABET))
        assertTrue(regex.containsMatchIn(UPPER_CASE_ALPHABET))
        assertFalse(regex.containsMatchIn(LOWER_CASE_ALPHABET))
        assertTrue(regex.containsMatchIn(DECIMAL_DIGITS))
        assertTrue(regex.containsMatchIn(BOTH_CASE_HEX_DIGITS))
        assertTrue(regex.containsMatchIn(UPPER_CASE_HEX_DIGITS))
        assertTrue(regex.containsMatchIn(LOWER_CASE_HEX_DIGITS))
        assertFalse(regex.containsMatchIn(SYMBOLS))
        assertFalse(regex.containsMatchIn(WHITE_SPACE))
        assertFalse(regex.containsMatchIn(CONTROL_CHARACTERS))
        assertFalse(regex.containsMatchIn(EMPTY))
        assertFalse(regex.containsMatchIn(SIMPLE_NAME))
        assertFalse(regex.containsMatchIn(SIMPLE_EMAIL_ADDRESS))
        assertFalse(regex.containsMatchIn(SIMPLE_HTTP_URL))
        assertFalse(regex.containsMatchIn(SIMPLE_HTTPS_URL))
        assertTrue(regex.containsMatchIn(IPV4_ADDRESS))
        assertTrue(regex.containsMatchIn(IPV6_ADDRESS))
        assertTrue(regex.containsMatchIn(MAC_ADDRESS))
    }

    @Test
    fun testLowercaseHexDigit() {
        val regex = RegexBuilder()
            .lowercaseHexDigit()
            .buildRegex()

        assertEquals("[0-9a-f]", regex.toString())
        assertFalse(regex.containsMatchIn("A"))
        assertTrue(regex.containsMatchIn("        f"))
        assertTrue(regex.containsMatchIn("text with Spaces"))
        assertFalse(regex.containsMatchIn(" "))
        assertTrue(regex.containsMatchIn("1"))
        assertFalse(regex.containsMatchIn("%"))
        assertFalse(regex.containsMatchIn("_"))
        assertFalse(regex.containsMatchIn("s"))
        assertFalse(regex.containsMatchIn(""))

        assertTrue(regex.containsMatchIn(BOTH_CASE_ALPHABET))
        assertFalse(regex.containsMatchIn(UPPER_CASE_ALPHABET))
        assertTrue(regex.containsMatchIn(LOWER_CASE_ALPHABET))
        assertTrue(regex.containsMatchIn(DECIMAL_DIGITS))
        assertTrue(regex.containsMatchIn(BOTH_CASE_HEX_DIGITS))
        assertTrue(regex.containsMatchIn(UPPER_CASE_HEX_DIGITS))
        assertTrue(regex.containsMatchIn(LOWER_CASE_HEX_DIGITS))
        assertFalse(regex.containsMatchIn(SYMBOLS))
        assertFalse(regex.containsMatchIn(WHITE_SPACE))
        assertFalse(regex.containsMatchIn(CONTROL_CHARACTERS))
        assertFalse(regex.containsMatchIn(EMPTY))
        assertFalse(regex.containsMatchIn(SIMPLE_NAME))
        assertTrue(regex.containsMatchIn(SIMPLE_EMAIL_ADDRESS))
        assertTrue(regex.containsMatchIn(SIMPLE_HTTP_URL))
        assertTrue(regex.containsMatchIn(SIMPLE_HTTPS_URL))
        assertTrue(regex.containsMatchIn(IPV4_ADDRESS))
        assertTrue(regex.containsMatchIn(IPV6_ADDRESS))
        assertTrue(regex.containsMatchIn(MAC_ADDRESS))
    }

    @Test
    fun testNonHexDigit() {
        val regex = RegexBuilder()
            .nonHexDigit()
            .buildRegex()

        assertEquals("[^0-9A-Fa-f]", regex.toString())
        assertFalse(regex.containsMatchIn("A"))
        assertTrue(regex.containsMatchIn("        f"))
        assertTrue(regex.containsMatchIn("text with Spaces"))
        assertTrue(regex.containsMatchIn(" "))
        assertFalse(regex.containsMatchIn("1"))
        assertTrue(regex.containsMatchIn("%"))
        assertTrue(regex.containsMatchIn("_"))
        assertTrue(regex.containsMatchIn("s"))
        assertFalse(regex.containsMatchIn(""))

        assertTrue(regex.containsMatchIn(BOTH_CASE_ALPHABET))
        assertTrue(regex.containsMatchIn(UPPER_CASE_ALPHABET))
        assertTrue(regex.containsMatchIn(LOWER_CASE_ALPHABET))
        assertFalse(regex.containsMatchIn(DECIMAL_DIGITS))
        assertFalse(regex.containsMatchIn(BOTH_CASE_HEX_DIGITS))
        assertFalse(regex.containsMatchIn(UPPER_CASE_HEX_DIGITS))
        assertFalse(regex.containsMatchIn(LOWER_CASE_HEX_DIGITS))
        assertTrue(regex.containsMatchIn(SYMBOLS))
        assertTrue(regex.containsMatchIn(WHITE_SPACE))
        assertTrue(regex.containsMatchIn(CONTROL_CHARACTERS))
        assertFalse(regex.containsMatchIn(EMPTY))
        assertTrue(regex.containsMatchIn(SIMPLE_NAME))
        assertTrue(regex.containsMatchIn(SIMPLE_EMAIL_ADDRESS))
        assertTrue(regex.containsMatchIn(SIMPLE_HTTP_URL))
        assertTrue(regex.containsMatchIn(SIMPLE_HTTPS_URL))
        assertTrue(regex.containsMatchIn(IPV4_ADDRESS))
        assertTrue(regex.containsMatchIn(IPV6_ADDRESS))
        assertTrue(regex.containsMatchIn(MAC_ADDRESS))
    }

    @Test
    fun testWordCharacter() {
        val regex = RegexBuilder()
            .wordCharacter()
            .buildRegex()

        assertEquals("\\w", regex.toString())
        assertTrue(regex.containsMatchIn("A"))
        assertTrue(regex.containsMatchIn("        Z"))
        assertTrue(regex.containsMatchIn("text with Spaces"))
        assertFalse(regex.containsMatchIn(" "))
        assertTrue(regex.containsMatchIn("1"))
        assertFalse(regex.containsMatchIn("%"))
        assertTrue(regex.containsMatchIn("_"))
        assertTrue(regex.containsMatchIn("s"))
        assertFalse(regex.containsMatchIn(""))

        assertTrue(regex.containsMatchIn(BOTH_CASE_ALPHABET))
        assertTrue(regex.containsMatchIn(UPPER_CASE_ALPHABET))
        assertTrue(regex.containsMatchIn(LOWER_CASE_ALPHABET))
        assertTrue(regex.containsMatchIn(DECIMAL_DIGITS))
        assertTrue(regex.containsMatchIn(BOTH_CASE_HEX_DIGITS))
        assertTrue(regex.containsMatchIn(UPPER_CASE_HEX_DIGITS))
        assertTrue(regex.containsMatchIn(LOWER_CASE_HEX_DIGITS))
        assertTrue(regex.containsMatchIn(SYMBOLS))
        assertFalse(regex.containsMatchIn(WHITE_SPACE))
        assertFalse(regex.containsMatchIn(CONTROL_CHARACTERS))
        assertFalse(regex.containsMatchIn(EMPTY))
        assertTrue(regex.containsMatchIn(SIMPLE_NAME))
        assertTrue(regex.containsMatchIn(SIMPLE_EMAIL_ADDRESS))
        assertTrue(regex.containsMatchIn(SIMPLE_HTTP_URL))
        assertTrue(regex.containsMatchIn(SIMPLE_HTTPS_URL))
        assertTrue(regex.containsMatchIn(IPV4_ADDRESS))
        assertTrue(regex.containsMatchIn(IPV6_ADDRESS))
        assertTrue(regex.containsMatchIn(MAC_ADDRESS))
    }

    @Test
    fun testNonWordCharacter() {
        val regex = RegexBuilder()
            .nonWordCharacter()
            .buildRegex()

        assertEquals("\\W", regex.toString())
        assertFalse(regex.containsMatchIn("A"))
        assertTrue(regex.containsMatchIn("        Z"))
        assertTrue(regex.containsMatchIn("text with Spaces"))
        assertTrue(regex.containsMatchIn(" "))
        assertFalse(regex.containsMatchIn("1"))
        assertTrue(regex.containsMatchIn("%"))
        assertFalse(regex.containsMatchIn("_"))
        assertFalse(regex.containsMatchIn("s"))
        assertFalse(regex.containsMatchIn(""))

        assertFalse(regex.containsMatchIn(BOTH_CASE_ALPHABET))
        assertFalse(regex.containsMatchIn(UPPER_CASE_ALPHABET))
        assertFalse(regex.containsMatchIn(LOWER_CASE_ALPHABET))
        assertFalse(regex.containsMatchIn(DECIMAL_DIGITS))
        assertFalse(regex.containsMatchIn(BOTH_CASE_HEX_DIGITS))
        assertFalse(regex.containsMatchIn(UPPER_CASE_HEX_DIGITS))
        assertFalse(regex.containsMatchIn(LOWER_CASE_HEX_DIGITS))
        assertTrue(regex.containsMatchIn(SYMBOLS))
        assertTrue(regex.containsMatchIn(WHITE_SPACE))
        assertTrue(regex.containsMatchIn(CONTROL_CHARACTERS))
        assertFalse(regex.containsMatchIn(EMPTY))
        assertTrue(regex.containsMatchIn(SIMPLE_NAME))
        assertTrue(regex.containsMatchIn(SIMPLE_EMAIL_ADDRESS))
        assertTrue(regex.containsMatchIn(SIMPLE_HTTP_URL))
        assertTrue(regex.containsMatchIn(SIMPLE_HTTPS_URL))
        assertTrue(regex.containsMatchIn(IPV4_ADDRESS))
        assertTrue(regex.containsMatchIn(IPV6_ADDRESS))
        assertTrue(regex.containsMatchIn(MAC_ADDRESS))
    }

    @Test
    fun testAnyCharacterFrom() {
        val regex = RegexBuilder()
            .anyCharacterFrom("cat")
            .buildRegex()

        assertEquals("[cat]", regex.toString())
        assertTrue(regex.containsMatchIn("cat"))
        assertTrue(regex.containsMatchIn("parrot"))
        assertTrue(regex.containsMatchIn("tiger"))
        assertTrue(regex.containsMatchIn("cow"))
        assertFalse(regex.containsMatchIn("CAT"))
        assertFalse(regex.containsMatchIn("dog"))
        assertFalse(regex.containsMatchIn(" "))
        assertFalse(regex.containsMatchIn(""))

        assertTrue(regex.containsMatchIn(BOTH_CASE_ALPHABET))
        assertFalse(regex.containsMatchIn(UPPER_CASE_ALPHABET))
        assertTrue(regex.containsMatchIn(LOWER_CASE_ALPHABET))
        assertFalse(regex.containsMatchIn(DECIMAL_DIGITS))
        assertTrue(regex.containsMatchIn(BOTH_CASE_HEX_DIGITS))
        assertFalse(regex.containsMatchIn(UPPER_CASE_HEX_DIGITS))
        assertTrue(regex.containsMatchIn(LOWER_CASE_HEX_DIGITS))
        assertFalse(regex.containsMatchIn(SYMBOLS))
        assertFalse(regex.containsMatchIn(WHITE_SPACE))
        assertFalse(regex.containsMatchIn(CONTROL_CHARACTERS))
        assertFalse(regex.containsMatchIn(EMPTY))
        assertTrue(regex.containsMatchIn(SIMPLE_NAME))
        assertTrue(regex.containsMatchIn(SIMPLE_EMAIL_ADDRESS))
        assertTrue(regex.containsMatchIn(SIMPLE_HTTP_URL))
        assertTrue(regex.containsMatchIn(SIMPLE_HTTPS_URL))
        assertFalse(regex.containsMatchIn(IPV4_ADDRESS))
        assertTrue(regex.containsMatchIn(IPV6_ADDRESS))
        assertTrue(regex.containsMatchIn(MAC_ADDRESS))
    }

    @Test
    fun testAnyCharacterFromWithCaretAtStart() {
        val regex = RegexBuilder()
            .anyCharacterFrom("^abc")
            .buildRegex()

        assertEquals("[\\^abc]", regex.toString())
        assertTrue(regex.containsMatchIn("jazz"))
        assertTrue(regex.containsMatchIn("_^_"))
        assertTrue(regex.containsMatchIn("oboe"))
        assertTrue(regex.containsMatchIn("cue"))
        assertFalse(regex.containsMatchIn("CAT"))
        assertFalse(regex.containsMatchIn("dog"))
        assertFalse(regex.containsMatchIn(" "))
        assertFalse(regex.containsMatchIn(""))

        assertTrue(regex.containsMatchIn(BOTH_CASE_ALPHABET))
        assertFalse(regex.containsMatchIn(UPPER_CASE_ALPHABET))
        assertTrue(regex.containsMatchIn(LOWER_CASE_ALPHABET))
        assertFalse(regex.containsMatchIn(DECIMAL_DIGITS))
        assertTrue(regex.containsMatchIn(BOTH_CASE_HEX_DIGITS))
        assertFalse(regex.containsMatchIn(UPPER_CASE_HEX_DIGITS))
        assertTrue(regex.containsMatchIn(LOWER_CASE_HEX_DIGITS))
        assertTrue(regex.containsMatchIn(SYMBOLS))
        assertFalse(regex.containsMatchIn(WHITE_SPACE))
        assertFalse(regex.containsMatchIn(CONTROL_CHARACTERS))
        assertFalse(regex.containsMatchIn(EMPTY))
        assertFalse(regex.containsMatchIn(SIMPLE_NAME))
        assertTrue(regex.containsMatchIn(SIMPLE_EMAIL_ADDRESS))
        assertTrue(regex.containsMatchIn(SIMPLE_HTTP_URL))
        assertTrue(regex.containsMatchIn(SIMPLE_HTTPS_URL))
        assertFalse(regex.containsMatchIn(IPV4_ADDRESS))
        assertTrue(regex.containsMatchIn(IPV6_ADDRESS))
        assertTrue(regex.containsMatchIn(MAC_ADDRESS))
    }

    @Test
    fun testAnyCharacterFromWithCaretNotAtStart() {
        val regex = RegexBuilder()
            .anyCharacterFrom("a^bc")
            .buildRegex()

        assertEquals("[a^bc]", regex.toString())
        assertTrue(regex.containsMatchIn("jazz"))
        assertTrue(regex.containsMatchIn("_^_"))
        assertTrue(regex.containsMatchIn("oboe"))
        assertTrue(regex.containsMatchIn("cue"))
        assertFalse(regex.containsMatchIn("CAT"))
        assertFalse(regex.containsMatchIn("dog"))
        assertFalse(regex.containsMatchIn(" "))
        assertFalse(regex.containsMatchIn(""))

        assertTrue(regex.containsMatchIn(BOTH_CASE_ALPHABET))
        assertFalse(regex.containsMatchIn(UPPER_CASE_ALPHABET))
        assertTrue(regex.containsMatchIn(LOWER_CASE_ALPHABET))
        assertFalse(regex.containsMatchIn(DECIMAL_DIGITS))
        assertTrue(regex.containsMatchIn(BOTH_CASE_HEX_DIGITS))
        assertFalse(regex.containsMatchIn(UPPER_CASE_HEX_DIGITS))
        assertTrue(regex.containsMatchIn(LOWER_CASE_HEX_DIGITS))
        assertTrue(regex.containsMatchIn(SYMBOLS))
        assertFalse(regex.containsMatchIn(WHITE_SPACE))
        assertFalse(regex.containsMatchIn(CONTROL_CHARACTERS))
        assertFalse(regex.containsMatchIn(EMPTY))
        assertFalse(regex.containsMatchIn(SIMPLE_NAME))
        assertTrue(regex.containsMatchIn(SIMPLE_EMAIL_ADDRESS))
        assertTrue(regex.containsMatchIn(SIMPLE_HTTP_URL))
        assertTrue(regex.containsMatchIn(SIMPLE_HTTPS_URL))
        assertFalse(regex.containsMatchIn(IPV4_ADDRESS))
        assertTrue(regex.containsMatchIn(IPV6_ADDRESS))
        assertTrue(regex.containsMatchIn(MAC_ADDRESS))
    }

    @Test
    fun testAnyCharacterExcept() {
        val regex = RegexBuilder()
            .anyCharacterExcept("cat")
            .buildRegex()

        assertEquals("[^cat]", regex.toString())
        assertFalse(regex.containsMatchIn("cat"))
        assertFalse(regex.containsMatchIn("tata"))
        assertTrue(regex.containsMatchIn("parrot"))
        assertTrue(regex.containsMatchIn("tiger"))
        assertTrue(regex.containsMatchIn("cow"))
        assertTrue(regex.containsMatchIn("CAT"))
        assertTrue(regex.containsMatchIn("dog"))
        assertTrue(regex.containsMatchIn(" "))
        assertFalse(regex.containsMatchIn(""))

        assertTrue(regex.containsMatchIn(BOTH_CASE_ALPHABET))
        assertTrue(regex.containsMatchIn(UPPER_CASE_ALPHABET))
        assertTrue(regex.containsMatchIn(LOWER_CASE_ALPHABET))
        assertTrue(regex.containsMatchIn(DECIMAL_DIGITS))
        assertTrue(regex.containsMatchIn(BOTH_CASE_HEX_DIGITS))
        assertTrue(regex.containsMatchIn(UPPER_CASE_HEX_DIGITS))
        assertTrue(regex.containsMatchIn(LOWER_CASE_HEX_DIGITS))
        assertTrue(regex.containsMatchIn(SYMBOLS))
        assertTrue(regex.containsMatchIn(WHITE_SPACE))
        assertTrue(regex.containsMatchIn(CONTROL_CHARACTERS))
        assertFalse(regex.containsMatchIn(EMPTY))
        assertTrue(regex.containsMatchIn(SIMPLE_NAME))
        assertTrue(regex.containsMatchIn(SIMPLE_EMAIL_ADDRESS))
        assertTrue(regex.containsMatchIn(SIMPLE_HTTP_URL))
        assertTrue(regex.containsMatchIn(SIMPLE_HTTPS_URL))
        assertTrue(regex.containsMatchIn(IPV4_ADDRESS))
        assertTrue(regex.containsMatchIn(IPV6_ADDRESS))
        assertTrue(regex.containsMatchIn(MAC_ADDRESS))
    }

    @Test
    fun testAnyOf() {
        val regex = RegexBuilder()
            .anyOf(listOf("cat", "dog", "|"))
            .buildRegex()

        assertEquals("(?:cat|dog|\\|)", regex.toString())
        assertFalse(regex.containsMatchIn("ca do"))
        assertTrue(regex.containsMatchIn("cat"))
        assertTrue(regex.containsMatchIn("dog"))
        assertTrue(regex.containsMatchIn("|"))

        assertFalse(regex.containsMatchIn(BOTH_CASE_ALPHABET))
        assertFalse(regex.containsMatchIn(UPPER_CASE_ALPHABET))
        assertFalse(regex.containsMatchIn(LOWER_CASE_ALPHABET))
        assertFalse(regex.containsMatchIn(DECIMAL_DIGITS))
        assertFalse(regex.containsMatchIn(BOTH_CASE_HEX_DIGITS))
        assertFalse(regex.containsMatchIn(UPPER_CASE_HEX_DIGITS))
        assertFalse(regex.containsMatchIn(LOWER_CASE_HEX_DIGITS))
        assertTrue(regex.containsMatchIn(SYMBOLS))
        assertFalse(regex.containsMatchIn(WHITE_SPACE))
        assertFalse(regex.containsMatchIn(CONTROL_CHARACTERS))
        assertFalse(regex.containsMatchIn(EMPTY))
        assertFalse(regex.containsMatchIn(SIMPLE_NAME))
        assertFalse(regex.containsMatchIn(SIMPLE_EMAIL_ADDRESS))
        assertFalse(regex.containsMatchIn(SIMPLE_HTTP_URL))
        assertFalse(regex.containsMatchIn(SIMPLE_HTTPS_URL))
        assertFalse(regex.containsMatchIn(IPV4_ADDRESS))
        assertFalse(regex.containsMatchIn(IPV6_ADDRESS))
        assertFalse(regex.containsMatchIn(MAC_ADDRESS))
    }

    @Test
    fun testAnyOfWithQuantifier() {
        val regex = RegexBuilder()
            .anyOf(listOf("cat", "dog", "|"), Exactly(2))
            .buildRegex()

        assertEquals("(?:cat|dog|\\|){2}", regex.toString())
        assertTrue(regex.containsMatchIn("catdog"))
        assertTrue(regex.containsMatchIn("cat|dog"))
        assertFalse(regex.containsMatchIn("cat"))
        assertTrue(regex.containsMatchIn("catcat"))
        assertTrue(regex.containsMatchIn("catcatcat"))
        assertFalse(regex.containsMatchIn("dog"))
        assertTrue(regex.containsMatchIn("dogdog"))
        assertTrue(regex.containsMatchIn("dogdogdog"))
        assertFalse(regex.containsMatchIn("|"))
        assertTrue(regex.containsMatchIn("||"))
        assertTrue(regex.containsMatchIn("|||"))

        assertFalse(regex.containsMatchIn(BOTH_CASE_ALPHABET))
        assertFalse(regex.containsMatchIn(UPPER_CASE_ALPHABET))
        assertFalse(regex.containsMatchIn(LOWER_CASE_ALPHABET))
        assertFalse(regex.containsMatchIn(DECIMAL_DIGITS))
        assertFalse(regex.containsMatchIn(BOTH_CASE_HEX_DIGITS))
        assertFalse(regex.containsMatchIn(UPPER_CASE_HEX_DIGITS))
        assertFalse(regex.containsMatchIn(LOWER_CASE_HEX_DIGITS))
        assertFalse(regex.containsMatchIn(SYMBOLS))
        assertFalse(regex.containsMatchIn(WHITE_SPACE))
        assertFalse(regex.containsMatchIn(CONTROL_CHARACTERS))
        assertFalse(regex.containsMatchIn(EMPTY))
        assertFalse(regex.containsMatchIn(SIMPLE_NAME))
        assertFalse(regex.containsMatchIn(SIMPLE_EMAIL_ADDRESS))
        assertFalse(regex.containsMatchIn(SIMPLE_HTTP_URL))
        assertFalse(regex.containsMatchIn(SIMPLE_HTTPS_URL))
        assertFalse(regex.containsMatchIn(IPV4_ADDRESS))
        assertFalse(regex.containsMatchIn(IPV6_ADDRESS))
        assertFalse(regex.containsMatchIn(MAC_ADDRESS))
    }

    @Test
    fun testVarargAnyOf() {
        val regex = RegexBuilder()
            .anyOf("cat", "dog", "|")
            .buildRegex()

        assertEquals("(?:cat|dog|\\|)", regex.toString())
        assertFalse(regex.containsMatchIn("ca do"))
        assertTrue(regex.containsMatchIn("cat"))
        assertTrue(regex.containsMatchIn("dog"))
        assertTrue(regex.containsMatchIn("|"))

        assertFalse(regex.containsMatchIn(BOTH_CASE_ALPHABET))
        assertFalse(regex.containsMatchIn(UPPER_CASE_ALPHABET))
        assertFalse(regex.containsMatchIn(LOWER_CASE_ALPHABET))
        assertFalse(regex.containsMatchIn(DECIMAL_DIGITS))
        assertFalse(regex.containsMatchIn(BOTH_CASE_HEX_DIGITS))
        assertFalse(regex.containsMatchIn(UPPER_CASE_HEX_DIGITS))
        assertFalse(regex.containsMatchIn(LOWER_CASE_HEX_DIGITS))
        assertTrue(regex.containsMatchIn(SYMBOLS))
        assertFalse(regex.containsMatchIn(WHITE_SPACE))
        assertFalse(regex.containsMatchIn(CONTROL_CHARACTERS))
        assertFalse(regex.containsMatchIn(EMPTY))
        assertFalse(regex.containsMatchIn(SIMPLE_NAME))
        assertFalse(regex.containsMatchIn(SIMPLE_EMAIL_ADDRESS))
        assertFalse(regex.containsMatchIn(SIMPLE_HTTP_URL))
        assertFalse(regex.containsMatchIn(SIMPLE_HTTPS_URL))
        assertFalse(regex.containsMatchIn(IPV4_ADDRESS))
        assertFalse(regex.containsMatchIn(IPV6_ADDRESS))
        assertFalse(regex.containsMatchIn(MAC_ADDRESS))
    }

    @Test
    fun testVarargAnyOfWithQuantifier() {
        val regex = RegexBuilder()
            .anyOf("cat", "dog", "|", quantifier = Exactly(2))
            .buildRegex()

        assertEquals("(?:cat|dog|\\|){2}", regex.toString())
        assertTrue(regex.containsMatchIn("catdog"))
        assertTrue(regex.containsMatchIn("cat|dog"))
        assertFalse(regex.containsMatchIn("cat"))
        assertTrue(regex.containsMatchIn("catcat"))
        assertTrue(regex.containsMatchIn("catcatcat"))
        assertFalse(regex.containsMatchIn("dog"))
        assertTrue(regex.containsMatchIn("dogdog"))
        assertTrue(regex.containsMatchIn("dogdogdog"))
        assertFalse(regex.containsMatchIn("|"))
        assertTrue(regex.containsMatchIn("||"))
        assertTrue(regex.containsMatchIn("|||"))

        assertFalse(regex.containsMatchIn(BOTH_CASE_ALPHABET))
        assertFalse(regex.containsMatchIn(UPPER_CASE_ALPHABET))
        assertFalse(regex.containsMatchIn(LOWER_CASE_ALPHABET))
        assertFalse(regex.containsMatchIn(DECIMAL_DIGITS))
        assertFalse(regex.containsMatchIn(BOTH_CASE_HEX_DIGITS))
        assertFalse(regex.containsMatchIn(UPPER_CASE_HEX_DIGITS))
        assertFalse(regex.containsMatchIn(LOWER_CASE_HEX_DIGITS))
        assertFalse(regex.containsMatchIn(SYMBOLS))
        assertFalse(regex.containsMatchIn(WHITE_SPACE))
        assertFalse(regex.containsMatchIn(CONTROL_CHARACTERS))
        assertFalse(regex.containsMatchIn(EMPTY))
        assertFalse(regex.containsMatchIn(SIMPLE_NAME))
        assertFalse(regex.containsMatchIn(SIMPLE_EMAIL_ADDRESS))
        assertFalse(regex.containsMatchIn(SIMPLE_HTTP_URL))
        assertFalse(regex.containsMatchIn(SIMPLE_HTTPS_URL))
        assertFalse(regex.containsMatchIn(IPV4_ADDRESS))
        assertFalse(regex.containsMatchIn(IPV6_ADDRESS))
        assertFalse(regex.containsMatchIn(MAC_ADDRESS))
    }

    @Test
    fun testAnyOfEmptyOrSingle() {
        val anyOfEmptyRegex = RegexBuilder()
            .anyOf(emptyList())
            .buildRegex()

        val anyOfSingleRegex = RegexBuilder()
            .anyOf(listOf("cat"))
            .buildRegex()

        assertEquals("", anyOfEmptyRegex.toString())
        assertEquals("cat", anyOfSingleRegex.toString())
    }

    @Test
    fun testStartOfString() {
        val regex = RegexBuilder()
            .startOfString()
            .text("a")
            .buildRegex()

        assertEquals("^a", regex.toString())
        assertTrue(regex.containsMatchIn("a"))
        assertTrue(regex.containsMatchIn("aA"))
        assertTrue(regex.containsMatchIn("a_"))
        assertTrue(regex.containsMatchIn("a        big gap"))
        assertFalse(regex.containsMatchIn(" a space before"))
        assertFalse(regex.containsMatchIn("A capital letter"))
        assertFalse(regex.containsMatchIn("Aa"))
        assertFalse(regex.containsMatchIn(" "))
        assertFalse(regex.containsMatchIn(""))

        assertFalse(regex.containsMatchIn(BOTH_CASE_ALPHABET))
        assertFalse(regex.containsMatchIn(UPPER_CASE_ALPHABET))
        assertTrue(regex.containsMatchIn(LOWER_CASE_ALPHABET))
        assertFalse(regex.containsMatchIn(DECIMAL_DIGITS))
        assertFalse(regex.containsMatchIn(BOTH_CASE_HEX_DIGITS))
        assertFalse(regex.containsMatchIn(UPPER_CASE_HEX_DIGITS))
        assertFalse(regex.containsMatchIn(LOWER_CASE_HEX_DIGITS))
        assertFalse(regex.containsMatchIn(SYMBOLS))
        assertFalse(regex.containsMatchIn(WHITE_SPACE))
        assertFalse(regex.containsMatchIn(CONTROL_CHARACTERS))
        assertFalse(regex.containsMatchIn(EMPTY))
        assertFalse(regex.containsMatchIn(SIMPLE_NAME))
        assertFalse(regex.containsMatchIn(SIMPLE_EMAIL_ADDRESS))
        assertFalse(regex.containsMatchIn(SIMPLE_HTTP_URL))
        assertFalse(regex.containsMatchIn(SIMPLE_HTTPS_URL))
        assertFalse(regex.containsMatchIn(IPV4_ADDRESS))
        assertFalse(regex.containsMatchIn(IPV6_ADDRESS))
        assertFalse(regex.containsMatchIn(MAC_ADDRESS))
    }

    @Test
    fun testEndOfString() {
        val regex = RegexBuilder()
            .text("z")
            .endOfString()
            .buildRegex()

        assertEquals("z$", regex.toString())
        assertTrue(regex.containsMatchIn("z"))
        assertTrue(regex.containsMatchIn("zzz"))
        assertTrue(regex.containsMatchIn("fizz buzz"))
        assertFalse(regex.containsMatchIn("buzz!"))
        assertFalse(regex.containsMatchIn("zzz "))
        assertFalse(regex.containsMatchIn("zZ"))
        assertFalse(regex.containsMatchIn("z "))
        assertFalse(regex.containsMatchIn(" "))
        assertFalse(regex.containsMatchIn(""))

        assertTrue(regex.containsMatchIn(BOTH_CASE_ALPHABET))
        assertFalse(regex.containsMatchIn(UPPER_CASE_ALPHABET))
        assertTrue(regex.containsMatchIn(LOWER_CASE_ALPHABET))
        assertFalse(regex.containsMatchIn(DECIMAL_DIGITS))
        assertFalse(regex.containsMatchIn(BOTH_CASE_HEX_DIGITS))
        assertFalse(regex.containsMatchIn(UPPER_CASE_HEX_DIGITS))
        assertFalse(regex.containsMatchIn(LOWER_CASE_HEX_DIGITS))
        assertFalse(regex.containsMatchIn(SYMBOLS))
        assertFalse(regex.containsMatchIn(WHITE_SPACE))
        assertFalse(regex.containsMatchIn(CONTROL_CHARACTERS))
        assertFalse(regex.containsMatchIn(EMPTY))
        assertFalse(regex.containsMatchIn(SIMPLE_NAME))
        assertFalse(regex.containsMatchIn(SIMPLE_EMAIL_ADDRESS))
        assertFalse(regex.containsMatchIn(SIMPLE_HTTP_URL))
        assertFalse(regex.containsMatchIn(SIMPLE_HTTPS_URL))
        assertFalse(regex.containsMatchIn(IPV4_ADDRESS))
        assertFalse(regex.containsMatchIn(IPV6_ADDRESS))
        assertFalse(regex.containsMatchIn(MAC_ADDRESS))
    }

    @Test
    fun testWordBoundary() {
        val regex = RegexBuilder()
            .text("a")
            .wordBoundary()
            .buildRegex()

        assertEquals("a\\b", regex.toString())
        assertTrue(regex.containsMatchIn("a"))
        assertTrue(regex.containsMatchIn("spa"))
        assertTrue(regex.containsMatchIn("papa don't preach"))
        assertTrue(regex.containsMatchIn("a dog"))
        assertTrue(regex.containsMatchIn("a-dog"))
        assertFalse(regex.containsMatchIn("an apple"))
        assertFalse(regex.containsMatchIn("asp"))
        assertFalse(regex.containsMatchIn("a1b"))
        assertFalse(regex.containsMatchIn("a_b"))
        assertFalse(regex.containsMatchIn(" "))
        assertFalse(regex.containsMatchIn(""))

        assertFalse(regex.containsMatchIn(BOTH_CASE_ALPHABET))
        assertFalse(regex.containsMatchIn(UPPER_CASE_ALPHABET))
        assertFalse(regex.containsMatchIn(LOWER_CASE_ALPHABET))
        assertFalse(regex.containsMatchIn(DECIMAL_DIGITS))
        assertFalse(regex.containsMatchIn(BOTH_CASE_HEX_DIGITS))
        assertFalse(regex.containsMatchIn(UPPER_CASE_HEX_DIGITS))
        assertFalse(regex.containsMatchIn(LOWER_CASE_HEX_DIGITS))
        assertFalse(regex.containsMatchIn(SYMBOLS))
        assertFalse(regex.containsMatchIn(WHITE_SPACE))
        assertFalse(regex.containsMatchIn(CONTROL_CHARACTERS))
        assertFalse(regex.containsMatchIn(EMPTY))
        assertFalse(regex.containsMatchIn(SIMPLE_NAME))
        assertFalse(regex.containsMatchIn(SIMPLE_EMAIL_ADDRESS))
        assertFalse(regex.containsMatchIn(SIMPLE_HTTP_URL))
        assertFalse(regex.containsMatchIn(SIMPLE_HTTPS_URL))
        assertFalse(regex.containsMatchIn(IPV4_ADDRESS))
        assertFalse(regex.containsMatchIn(IPV6_ADDRESS))
        assertFalse(regex.containsMatchIn(MAC_ADDRESS))
    }

    @Test
    fun testSingleGroup() {
        val regex = RegexBuilder()
            .anyCharacter(ZeroOrMore)
            .startGroup()
            .letter()
            .digit()
            .endGroup()
            .buildRegex()

        assertEquals(".*([a-zA-Z]\\d)", regex.toString())

        var match = regex.find("Class A1")
        assertNotNull(match)
        assertEquals("Class A1", match!!.value)
        assertEquals("A1", match.groupValues[1])

        match = regex.find("he likes F1 racing")
        assertNotNull(match)
        assertEquals("he likes F1", match!!.value)
        assertEquals("F1", match.groupValues[1])

        match = regex.find("A4 paper")
        assertNotNull(match)
        assertEquals("A4", match!!.value)
        assertEquals("A4", match.groupValues[1])

        match = regex.find("A 4-legged dog")
        assertNull(match)

        assertFalse(regex.containsMatchIn(BOTH_CASE_ALPHABET))
        assertFalse(regex.containsMatchIn(UPPER_CASE_ALPHABET))
        assertFalse(regex.containsMatchIn(LOWER_CASE_ALPHABET))
        assertFalse(regex.containsMatchIn(DECIMAL_DIGITS))
        assertFalse(regex.containsMatchIn(BOTH_CASE_HEX_DIGITS))
        assertFalse(regex.containsMatchIn(UPPER_CASE_HEX_DIGITS))
        assertFalse(regex.containsMatchIn(LOWER_CASE_HEX_DIGITS))
        assertFalse(regex.containsMatchIn(SYMBOLS))
        assertFalse(regex.containsMatchIn(WHITE_SPACE))
        assertFalse(regex.containsMatchIn(CONTROL_CHARACTERS))
        assertFalse(regex.containsMatchIn(EMPTY))
        assertFalse(regex.containsMatchIn(SIMPLE_NAME))
        assertFalse(regex.containsMatchIn(SIMPLE_EMAIL_ADDRESS))
        assertFalse(regex.containsMatchIn(SIMPLE_HTTP_URL))
        assertFalse(regex.containsMatchIn(SIMPLE_HTTPS_URL))
        assertFalse(regex.containsMatchIn(IPV4_ADDRESS))
        assertTrue(regex.containsMatchIn(IPV6_ADDRESS))
        assertTrue(regex.containsMatchIn(MAC_ADDRESS))
    }

    @Test
    fun testRepeatGroup() {
        val regex = RegexBuilder()
            .startGroup()
            .letter()
            .digit()
            .endGroup()
            .buildRegex()

        assertEquals("([a-zA-Z]\\d)", regex.toString())

        var matcher = regex.find("Class A1 f2 ZZ88")
        val matches = mutableListOf<String>()
        while (matcher != null) {
            matches.add(matcher.value)
            matcher = matcher.next()
        }
        assertEquals(3, matches.size)
        assertEquals("A1", matches[0])
        assertEquals("f2", matches[1])
        assertEquals("Z8", matches[2])

        assertFalse(regex.containsMatchIn(BOTH_CASE_ALPHABET))
        assertFalse(regex.containsMatchIn(UPPER_CASE_ALPHABET))
        assertFalse(regex.containsMatchIn(LOWER_CASE_ALPHABET))
        assertFalse(regex.containsMatchIn(DECIMAL_DIGITS))
        assertFalse(regex.containsMatchIn(BOTH_CASE_HEX_DIGITS))
        assertFalse(regex.containsMatchIn(UPPER_CASE_HEX_DIGITS))
        assertFalse(regex.containsMatchIn(LOWER_CASE_HEX_DIGITS))
        assertFalse(regex.containsMatchIn(SYMBOLS))
        assertFalse(regex.containsMatchIn(WHITE_SPACE))
        assertFalse(regex.containsMatchIn(CONTROL_CHARACTERS))
        assertFalse(regex.containsMatchIn(EMPTY))
        assertFalse(regex.containsMatchIn(SIMPLE_NAME))
        assertFalse(regex.containsMatchIn(SIMPLE_EMAIL_ADDRESS))
        assertFalse(regex.containsMatchIn(SIMPLE_HTTP_URL))
        assertFalse(regex.containsMatchIn(SIMPLE_HTTPS_URL))
        assertFalse(regex.containsMatchIn(IPV4_ADDRESS))
        assertTrue(regex.containsMatchIn(IPV6_ADDRESS))
        assertTrue(regex.containsMatchIn(MAC_ADDRESS))
    }

    @Test
    fun testNamedGroup() {
        val regex = RegexBuilder()
            .lowercaseLetter(OneOrMore)
            .startNamedGroup("test123")
            .digit(OneOrMore)
            .endGroup()
            .lowercaseLetter(OneOrMore)
            .buildRegex()

        assertEquals("[a-z]+(?<test123>\\d+)[a-z]+", regex.toString())

        val match = regex.find("a99z")
        assertNotNull(match)
        assertEquals("a99z", match!!.value)
        assertEquals("99", match.groupValues[1])
        assertEquals("99", match.groups["test123"]?.value)

        assertFalse(regex.containsMatchIn(BOTH_CASE_ALPHABET))
        assertFalse(regex.containsMatchIn(UPPER_CASE_ALPHABET))
        assertFalse(regex.containsMatchIn(LOWER_CASE_ALPHABET))
        assertFalse(regex.containsMatchIn(DECIMAL_DIGITS))
        assertFalse(regex.containsMatchIn(BOTH_CASE_HEX_DIGITS))
        assertFalse(regex.containsMatchIn(UPPER_CASE_HEX_DIGITS))
        assertFalse(regex.containsMatchIn(LOWER_CASE_HEX_DIGITS))
        assertFalse(regex.containsMatchIn(SYMBOLS))
        assertFalse(regex.containsMatchIn(WHITE_SPACE))
        assertFalse(regex.containsMatchIn(CONTROL_CHARACTERS))
        assertFalse(regex.containsMatchIn(EMPTY))
        assertFalse(regex.containsMatchIn(SIMPLE_NAME))
        assertFalse(regex.containsMatchIn(SIMPLE_EMAIL_ADDRESS))
        assertFalse(regex.containsMatchIn(SIMPLE_HTTP_URL))
        assertFalse(regex.containsMatchIn(SIMPLE_HTTPS_URL))
        assertFalse(regex.containsMatchIn(IPV4_ADDRESS))
        assertTrue(regex.containsMatchIn(IPV6_ADDRESS))
        assertFalse(regex.containsMatchIn(MAC_ADDRESS))
    }

    @Test
    fun testNonCapturingGroup() {
        val regex = RegexBuilder()
            .lowercaseLetter(OneOrMore)
            .startNonCapturingGroup()
            .digit(OneOrMore)
            .endGroup()
            .lowercaseLetter(OneOrMore)
            .buildRegex()

        assertEquals("[a-z]+(?:\\d+)[a-z]+", regex.toString())

        val match = regex.find("a99z")
        assertNotNull(match)
        assertEquals("a99z", match!!.value)
        assertEquals(1, match.groups.size)

        assertFalse(regex.containsMatchIn(BOTH_CASE_ALPHABET))
        assertFalse(regex.containsMatchIn(UPPER_CASE_ALPHABET))
        assertFalse(regex.containsMatchIn(LOWER_CASE_ALPHABET))
        assertFalse(regex.containsMatchIn(DECIMAL_DIGITS))
        assertFalse(regex.containsMatchIn(BOTH_CASE_HEX_DIGITS))
        assertFalse(regex.containsMatchIn(UPPER_CASE_HEX_DIGITS))
        assertFalse(regex.containsMatchIn(LOWER_CASE_HEX_DIGITS))
        assertFalse(regex.containsMatchIn(SYMBOLS))
        assertFalse(regex.containsMatchIn(WHITE_SPACE))
        assertFalse(regex.containsMatchIn(CONTROL_CHARACTERS))
        assertFalse(regex.containsMatchIn(EMPTY))
        assertFalse(regex.containsMatchIn(SIMPLE_NAME))
        assertFalse(regex.containsMatchIn(SIMPLE_EMAIL_ADDRESS))
        assertFalse(regex.containsMatchIn(SIMPLE_HTTP_URL))
        assertFalse(regex.containsMatchIn(SIMPLE_HTTPS_URL))
        assertFalse(regex.containsMatchIn(IPV4_ADDRESS))
        assertTrue(regex.containsMatchIn(IPV6_ADDRESS))
        assertFalse(regex.containsMatchIn(MAC_ADDRESS))
    }

    @Test
    fun testMultipleGroups() {
        val regex = RegexBuilder()
            .startGroup()
            .anyCharacter(ZeroOrMore)
            .endGroup()
            .startGroup()
            .letter()
            .digit()
            .endGroup()
            .buildRegex()

        assertEquals("(.*)([a-zA-Z]\\d)", regex.toString())

        var match = regex.find("Class A1")
        assertNotNull(match)
        assertEquals("Class A1", match!!.value)
        assertEquals("Class ", match.groupValues[1])
        assertEquals("A1", match.groupValues[2])

        match = regex.find("he likes F1 racing")
        assertNotNull(match)
        assertEquals("he likes F1", match!!.value)
        assertEquals("he likes ", match.groupValues[1])
        assertEquals("F1", match.groupValues[2])

        match = regex.find("A4 paper")
        assertNotNull(match)
        assertEquals("A4", match!!.value)
        assertEquals("", match.groupValues[1])
        assertEquals("A4", match.groupValues[2])

        match = regex.find("A 4-legged dog")
        assertNull(match)

        assertFalse(regex.containsMatchIn(BOTH_CASE_ALPHABET))
        assertFalse(regex.containsMatchIn(UPPER_CASE_ALPHABET))
        assertFalse(regex.containsMatchIn(LOWER_CASE_ALPHABET))
        assertFalse(regex.containsMatchIn(DECIMAL_DIGITS))
        assertFalse(regex.containsMatchIn(BOTH_CASE_HEX_DIGITS))
        assertFalse(regex.containsMatchIn(UPPER_CASE_HEX_DIGITS))
        assertFalse(regex.containsMatchIn(LOWER_CASE_HEX_DIGITS))
        assertFalse(regex.containsMatchIn(SYMBOLS))
        assertFalse(regex.containsMatchIn(WHITE_SPACE))
        assertFalse(regex.containsMatchIn(CONTROL_CHARACTERS))
        assertFalse(regex.containsMatchIn(EMPTY))
        assertFalse(regex.containsMatchIn(SIMPLE_NAME))
        assertFalse(regex.containsMatchIn(SIMPLE_EMAIL_ADDRESS))
        assertFalse(regex.containsMatchIn(SIMPLE_HTTP_URL))
        assertFalse(regex.containsMatchIn(SIMPLE_HTTPS_URL))
        assertFalse(regex.containsMatchIn(IPV4_ADDRESS))
        assertTrue(regex.containsMatchIn(IPV6_ADDRESS))
        assertTrue(regex.containsMatchIn(MAC_ADDRESS))
    }

    @Test
    fun testNestedGroups() {
        val regex = RegexBuilder()
            .anyCharacter() // Omit first character from groups
            .startGroup()
            .anyCharacter(ZeroOrMore)
            .startGroup()
            .letter()
            .digit()
            .endGroup()
            .endGroup()
            .buildRegex()

        assertEquals(".(.*([a-zA-Z]\\d))", regex.toString())

        var match = regex.find("Class A1")
        assertNotNull(match)
        assertEquals("Class A1", match!!.value)
        assertEquals("lass A1", match.groupValues[1])
        assertEquals("A1", match.groupValues[2])

        match = regex.find("he likes F1 racing")
        assertNotNull(match)
        assertEquals("he likes F1", match!!.value)
        assertEquals("e likes F1", match.groupValues[1])
        assertEquals("F1", match.groupValues[2])

        match = regex.find(" A4 paper")
        assertNotNull(match)
        assertEquals(" A4", match!!.value)
        assertEquals("A4", match.groupValues[1])
        assertEquals("A4", match.groupValues[2])

        match = regex.find("A 4-legged dog")
        assertNull(match)

        assertFalse(regex.containsMatchIn(BOTH_CASE_ALPHABET))
        assertFalse(regex.containsMatchIn(UPPER_CASE_ALPHABET))
        assertFalse(regex.containsMatchIn(LOWER_CASE_ALPHABET))
        assertFalse(regex.containsMatchIn(DECIMAL_DIGITS))
        assertFalse(regex.containsMatchIn(BOTH_CASE_HEX_DIGITS))
        assertFalse(regex.containsMatchIn(UPPER_CASE_HEX_DIGITS))
        assertFalse(regex.containsMatchIn(LOWER_CASE_HEX_DIGITS))
        assertFalse(regex.containsMatchIn(SYMBOLS))
        assertFalse(regex.containsMatchIn(WHITE_SPACE))
        assertFalse(regex.containsMatchIn(CONTROL_CHARACTERS))
        assertFalse(regex.containsMatchIn(EMPTY))
        assertFalse(regex.containsMatchIn(SIMPLE_NAME))
        assertFalse(regex.containsMatchIn(SIMPLE_EMAIL_ADDRESS))
        assertFalse(regex.containsMatchIn(SIMPLE_HTTP_URL))
        assertFalse(regex.containsMatchIn(SIMPLE_HTTPS_URL))
        assertFalse(regex.containsMatchIn(IPV4_ADDRESS))
        assertTrue(regex.containsMatchIn(IPV6_ADDRESS))
        assertTrue(regex.containsMatchIn(MAC_ADDRESS))
    }

    @Test
    fun testZeroOrMore() {
        val regex = RegexBuilder()
            .letter()
            .digit(ZeroOrMore)
            .letter()
            .buildRegex()

        assertEquals("[a-zA-Z]\\d*[a-zA-Z]", regex.toString())
        assertTrue(regex.containsMatchIn("ab"))
        assertTrue(regex.containsMatchIn("a1b"))
        assertTrue(regex.containsMatchIn("a123b"))
        assertFalse(regex.containsMatchIn("a 1 b"))
        assertFalse(regex.containsMatchIn("a b"))
        assertFalse(regex.containsMatchIn(" "))
        assertFalse(regex.containsMatchIn(""))

        assertTrue(regex.containsMatchIn(BOTH_CASE_ALPHABET))
        assertTrue(regex.containsMatchIn(UPPER_CASE_ALPHABET))
        assertTrue(regex.containsMatchIn(LOWER_CASE_ALPHABET))
        assertFalse(regex.containsMatchIn(DECIMAL_DIGITS))
        assertTrue(regex.containsMatchIn(BOTH_CASE_HEX_DIGITS))
        assertTrue(regex.containsMatchIn(UPPER_CASE_HEX_DIGITS))
        assertTrue(regex.containsMatchIn(LOWER_CASE_HEX_DIGITS))
        assertFalse(regex.containsMatchIn(SYMBOLS))
        assertFalse(regex.containsMatchIn(WHITE_SPACE))
        assertFalse(regex.containsMatchIn(CONTROL_CHARACTERS))
        assertFalse(regex.containsMatchIn(EMPTY))
        assertTrue(regex.containsMatchIn(SIMPLE_NAME))
        assertTrue(regex.containsMatchIn(SIMPLE_EMAIL_ADDRESS))
        assertTrue(regex.containsMatchIn(SIMPLE_HTTP_URL))
        assertTrue(regex.containsMatchIn(SIMPLE_HTTPS_URL))
        assertFalse(regex.containsMatchIn(IPV4_ADDRESS))
        assertTrue(regex.containsMatchIn(IPV6_ADDRESS))
        assertTrue(regex.containsMatchIn(MAC_ADDRESS))
    }

    @Test
    fun testOneOrMore() {
        val regex = RegexBuilder()
            .letter()
            .digit(OneOrMore)
            .letter()
            .buildRegex()

        assertEquals("[a-zA-Z]\\d+[a-zA-Z]", regex.toString())
        assertFalse(regex.containsMatchIn("ab"))
        assertTrue(regex.containsMatchIn("a1b"))
        assertTrue(regex.containsMatchIn("a123b"))
        assertFalse(regex.containsMatchIn("a 1 b"))
        assertFalse(regex.containsMatchIn("a b"))
        assertFalse(regex.containsMatchIn(" "))
        assertFalse(regex.containsMatchIn(""))

        assertFalse(regex.containsMatchIn(BOTH_CASE_ALPHABET))
        assertFalse(regex.containsMatchIn(UPPER_CASE_ALPHABET))
        assertFalse(regex.containsMatchIn(LOWER_CASE_ALPHABET))
        assertFalse(regex.containsMatchIn(DECIMAL_DIGITS))
        assertFalse(regex.containsMatchIn(BOTH_CASE_HEX_DIGITS))
        assertFalse(regex.containsMatchIn(UPPER_CASE_HEX_DIGITS))
        assertFalse(regex.containsMatchIn(LOWER_CASE_HEX_DIGITS))
        assertFalse(regex.containsMatchIn(SYMBOLS))
        assertFalse(regex.containsMatchIn(WHITE_SPACE))
        assertFalse(regex.containsMatchIn(CONTROL_CHARACTERS))
        assertFalse(regex.containsMatchIn(EMPTY))
        assertFalse(regex.containsMatchIn(SIMPLE_NAME))
        assertFalse(regex.containsMatchIn(SIMPLE_EMAIL_ADDRESS))
        assertFalse(regex.containsMatchIn(SIMPLE_HTTP_URL))
        assertFalse(regex.containsMatchIn(SIMPLE_HTTPS_URL))
        assertFalse(regex.containsMatchIn(IPV4_ADDRESS))
        assertTrue(regex.containsMatchIn(IPV6_ADDRESS))
        assertFalse(regex.containsMatchIn(MAC_ADDRESS))
    }

    @Test
    fun testZeroOrOne() {
        val regex = RegexBuilder()
            .letter()
            .digit(ZeroOrOne)
            .letter()
            .buildRegex()

        assertEquals("[a-zA-Z]\\d?[a-zA-Z]", regex.toString())
        assertTrue(regex.containsMatchIn("ab"))
        assertTrue(regex.containsMatchIn("a1b"))
        assertFalse(regex.containsMatchIn("a123b"))
        assertFalse(regex.containsMatchIn("a 1 b"))
        assertFalse(regex.containsMatchIn("a b"))
        assertFalse(regex.containsMatchIn(" "))
        assertFalse(regex.containsMatchIn(""))

        assertTrue(regex.containsMatchIn(BOTH_CASE_ALPHABET))
        assertTrue(regex.containsMatchIn(UPPER_CASE_ALPHABET))
        assertTrue(regex.containsMatchIn(LOWER_CASE_ALPHABET))
        assertFalse(regex.containsMatchIn(DECIMAL_DIGITS))
        assertTrue(regex.containsMatchIn(BOTH_CASE_HEX_DIGITS))
        assertTrue(regex.containsMatchIn(UPPER_CASE_HEX_DIGITS))
        assertTrue(regex.containsMatchIn(LOWER_CASE_HEX_DIGITS))
        assertFalse(regex.containsMatchIn(SYMBOLS))
        assertFalse(regex.containsMatchIn(WHITE_SPACE))
        assertFalse(regex.containsMatchIn(CONTROL_CHARACTERS))
        assertFalse(regex.containsMatchIn(EMPTY))
        assertTrue(regex.containsMatchIn(SIMPLE_NAME))
        assertTrue(regex.containsMatchIn(SIMPLE_EMAIL_ADDRESS))
        assertTrue(regex.containsMatchIn(SIMPLE_HTTP_URL))
        assertTrue(regex.containsMatchIn(SIMPLE_HTTPS_URL))
        assertFalse(regex.containsMatchIn(IPV4_ADDRESS))
        assertTrue(regex.containsMatchIn(IPV6_ADDRESS))
        assertTrue(regex.containsMatchIn(MAC_ADDRESS))
    }

    @Test
    fun testExactlyNTimes() {
        val regex = RegexBuilder()
            .letter()
            .digit(Exactly(3))
            .letter()
            .buildRegex()

        assertEquals("[a-zA-Z]\\d{3}[a-zA-Z]", regex.toString())
        assertFalse(regex.containsMatchIn("ab"))
        assertFalse(regex.containsMatchIn("a1b"))
        assertFalse(regex.containsMatchIn("a12b"))
        assertTrue(regex.containsMatchIn("a123b"))
        assertFalse(regex.containsMatchIn("a1234b"))
        assertFalse(regex.containsMatchIn("a12345b"))
        assertFalse(regex.containsMatchIn("a 1 b"))
        assertFalse(regex.containsMatchIn("a b"))
        assertFalse(regex.containsMatchIn(" "))
        assertFalse(regex.containsMatchIn(""))

        assertFalse(regex.containsMatchIn(BOTH_CASE_ALPHABET))
        assertFalse(regex.containsMatchIn(UPPER_CASE_ALPHABET))
        assertFalse(regex.containsMatchIn(LOWER_CASE_ALPHABET))
        assertFalse(regex.containsMatchIn(DECIMAL_DIGITS))
        assertFalse(regex.containsMatchIn(BOTH_CASE_HEX_DIGITS))
        assertFalse(regex.containsMatchIn(UPPER_CASE_HEX_DIGITS))
        assertFalse(regex.containsMatchIn(LOWER_CASE_HEX_DIGITS))
        assertFalse(regex.containsMatchIn(SYMBOLS))
        assertFalse(regex.containsMatchIn(WHITE_SPACE))
        assertFalse(regex.containsMatchIn(CONTROL_CHARACTERS))
        assertFalse(regex.containsMatchIn(EMPTY))
        assertFalse(regex.containsMatchIn(SIMPLE_NAME))
        assertFalse(regex.containsMatchIn(SIMPLE_EMAIL_ADDRESS))
        assertFalse(regex.containsMatchIn(SIMPLE_HTTP_URL))
        assertFalse(regex.containsMatchIn(SIMPLE_HTTPS_URL))
        assertFalse(regex.containsMatchIn(IPV4_ADDRESS))
        assertFalse(regex.containsMatchIn(IPV6_ADDRESS))
        assertFalse(regex.containsMatchIn(MAC_ADDRESS))
    }

    @Test
    fun testAtLeastQuantifier() {
        val regex = RegexBuilder()
            .letter()
            .digit(AtLeast(3))
            .letter()
            .buildRegex()

        assertEquals("[a-zA-Z]\\d{3,}[a-zA-Z]", regex.toString())
        assertFalse(regex.containsMatchIn("ab"))
        assertFalse(regex.containsMatchIn("a1b"))
        assertFalse(regex.containsMatchIn("a12b"))
        assertTrue(regex.containsMatchIn("a123b"))
        assertTrue(regex.containsMatchIn("a1234b"))
        assertTrue(regex.containsMatchIn("a12345b"))
        assertFalse(regex.containsMatchIn("a 1 b"))
        assertFalse(regex.containsMatchIn("a b"))
        assertFalse(regex.containsMatchIn(" "))
        assertFalse(regex.containsMatchIn(""))

        assertFalse(regex.containsMatchIn(BOTH_CASE_ALPHABET))
        assertFalse(regex.containsMatchIn(UPPER_CASE_ALPHABET))
        assertFalse(regex.containsMatchIn(LOWER_CASE_ALPHABET))
        assertFalse(regex.containsMatchIn(DECIMAL_DIGITS))
        assertFalse(regex.containsMatchIn(BOTH_CASE_HEX_DIGITS))
        assertFalse(regex.containsMatchIn(UPPER_CASE_HEX_DIGITS))
        assertFalse(regex.containsMatchIn(LOWER_CASE_HEX_DIGITS))
        assertFalse(regex.containsMatchIn(SYMBOLS))
        assertFalse(regex.containsMatchIn(WHITE_SPACE))
        assertFalse(regex.containsMatchIn(CONTROL_CHARACTERS))
        assertFalse(regex.containsMatchIn(EMPTY))
        assertFalse(regex.containsMatchIn(SIMPLE_NAME))
        assertFalse(regex.containsMatchIn(SIMPLE_EMAIL_ADDRESS))
        assertFalse(regex.containsMatchIn(SIMPLE_HTTP_URL))
        assertFalse(regex.containsMatchIn(SIMPLE_HTTPS_URL))
        assertFalse(regex.containsMatchIn(IPV4_ADDRESS))
        assertFalse(regex.containsMatchIn(IPV6_ADDRESS))
        assertFalse(regex.containsMatchIn(MAC_ADDRESS))
    }

    @Test
    fun testNoMoreThanQuantifier() {
        val regex = RegexBuilder()
            .letter()
            .digit(NoMoreThan(3))
            .letter()
            .buildRegex()

        assertEquals("[a-zA-Z]\\d{0,3}[a-zA-Z]", regex.toString())
        assertTrue(regex.containsMatchIn("ab"))
        assertTrue(regex.containsMatchIn("a1b"))
        assertTrue(regex.containsMatchIn("a12b"))
        assertTrue(regex.containsMatchIn("a123b"))
        assertFalse(regex.containsMatchIn("a1234b"))
        assertFalse(regex.containsMatchIn("a12345b"))
        assertFalse(regex.containsMatchIn("a 1 b"))
        assertFalse(regex.containsMatchIn("a b"))
        assertFalse(regex.containsMatchIn(" "))
        assertFalse(regex.containsMatchIn(""))

        assertTrue(regex.containsMatchIn(BOTH_CASE_ALPHABET))
        assertTrue(regex.containsMatchIn(UPPER_CASE_ALPHABET))
        assertTrue(regex.containsMatchIn(LOWER_CASE_ALPHABET))
        assertFalse(regex.containsMatchIn(DECIMAL_DIGITS))
        assertTrue(regex.containsMatchIn(BOTH_CASE_HEX_DIGITS))
        assertTrue(regex.containsMatchIn(UPPER_CASE_HEX_DIGITS))
        assertTrue(regex.containsMatchIn(LOWER_CASE_HEX_DIGITS))
        assertFalse(regex.containsMatchIn(SYMBOLS))
        assertFalse(regex.containsMatchIn(WHITE_SPACE))
        assertFalse(regex.containsMatchIn(CONTROL_CHARACTERS))
        assertFalse(regex.containsMatchIn(EMPTY))
        assertTrue(regex.containsMatchIn(SIMPLE_NAME))
        assertTrue(regex.containsMatchIn(SIMPLE_EMAIL_ADDRESS))
        assertTrue(regex.containsMatchIn(SIMPLE_HTTP_URL))
        assertTrue(regex.containsMatchIn(SIMPLE_HTTPS_URL))
        assertFalse(regex.containsMatchIn(IPV4_ADDRESS))
        assertTrue(regex.containsMatchIn(IPV6_ADDRESS))
        assertTrue(regex.containsMatchIn(MAC_ADDRESS))
    }

    @Test
    fun testBetweenMinMaxTimes() {
        val regex = RegexBuilder()
            .letter()
            .digit(Between(2, 4))
            .letter()
            .buildRegex()

        assertEquals("[a-zA-Z]\\d{2,4}[a-zA-Z]", regex.toString())
        assertFalse(regex.containsMatchIn("ab"))
        assertFalse(regex.containsMatchIn("a1b"))
        assertTrue(regex.containsMatchIn("a12b"))
        assertTrue(regex.containsMatchIn("a123b"))
        assertTrue(regex.containsMatchIn("a1234b"))
        assertFalse(regex.containsMatchIn("a12345b"))
        assertFalse(regex.containsMatchIn("a 1 b"))
        assertFalse(regex.containsMatchIn("a b"))
        assertFalse(regex.containsMatchIn(" "))
        assertFalse(regex.containsMatchIn(""))

        assertFalse(regex.containsMatchIn(BOTH_CASE_ALPHABET))
        assertFalse(regex.containsMatchIn(UPPER_CASE_ALPHABET))
        assertFalse(regex.containsMatchIn(LOWER_CASE_ALPHABET))
        assertFalse(regex.containsMatchIn(DECIMAL_DIGITS))
        assertFalse(regex.containsMatchIn(BOTH_CASE_HEX_DIGITS))
        assertFalse(regex.containsMatchIn(UPPER_CASE_HEX_DIGITS))
        assertFalse(regex.containsMatchIn(LOWER_CASE_HEX_DIGITS))
        assertFalse(regex.containsMatchIn(SYMBOLS))
        assertFalse(regex.containsMatchIn(WHITE_SPACE))
        assertFalse(regex.containsMatchIn(CONTROL_CHARACTERS))
        assertFalse(regex.containsMatchIn(EMPTY))
        assertFalse(regex.containsMatchIn(SIMPLE_NAME))
        assertFalse(regex.containsMatchIn(SIMPLE_EMAIL_ADDRESS))
        assertFalse(regex.containsMatchIn(SIMPLE_HTTP_URL))
        assertFalse(regex.containsMatchIn(SIMPLE_HTTPS_URL))
        assertFalse(regex.containsMatchIn(IPV4_ADDRESS))
        assertFalse(regex.containsMatchIn(IPV6_ADDRESS))
        assertFalse(regex.containsMatchIn(MAC_ADDRESS))
    }

    @Test
    fun testOptionMultiLine() {
        val regex = RegexBuilder()
            .startOfString()
            .text("find me!")
            .endOfString()
            .buildRegex(MULTILINE)

        assertEquals("^find me!$", regex.toString())
        assertTrue(regex.containsMatchIn("find me!"))
        assertTrue(regex.containsMatchIn("find me!\nline 2"))
        assertTrue(regex.containsMatchIn("line 1\nfind me!"))
        assertTrue(regex.containsMatchIn("line 1\nfind me!\nline 3"))
        assertFalse(regex.containsMatchIn(" find me!"))
        assertFalse(regex.containsMatchIn("find me! "))
        assertFalse(regex.containsMatchIn(" find me! "))
        assertFalse(regex.containsMatchIn(""))

        assertFalse(regex.containsMatchIn(BOTH_CASE_ALPHABET))
        assertFalse(regex.containsMatchIn(UPPER_CASE_ALPHABET))
        assertFalse(regex.containsMatchIn(LOWER_CASE_ALPHABET))
        assertFalse(regex.containsMatchIn(DECIMAL_DIGITS))
        assertFalse(regex.containsMatchIn(BOTH_CASE_HEX_DIGITS))
        assertFalse(regex.containsMatchIn(UPPER_CASE_HEX_DIGITS))
        assertFalse(regex.containsMatchIn(LOWER_CASE_HEX_DIGITS))
        assertFalse(regex.containsMatchIn(SYMBOLS))
        assertFalse(regex.containsMatchIn(WHITE_SPACE))
        assertFalse(regex.containsMatchIn(CONTROL_CHARACTERS))
        assertFalse(regex.containsMatchIn(EMPTY))
        assertFalse(regex.containsMatchIn(SIMPLE_NAME))
        assertFalse(regex.containsMatchIn(SIMPLE_EMAIL_ADDRESS))
        assertFalse(regex.containsMatchIn(SIMPLE_HTTP_URL))
        assertFalse(regex.containsMatchIn(SIMPLE_HTTPS_URL))
        assertFalse(regex.containsMatchIn(IPV4_ADDRESS))
        assertFalse(regex.containsMatchIn(IPV6_ADDRESS))
        assertFalse(regex.containsMatchIn(MAC_ADDRESS))
    }

    @Test
    fun testOptionIgnoreCase() {
        val regex = RegexBuilder()
            .anyCharacterFrom("cat")
            .buildRegex(IGNORE_CASE)

        assertEquals("[cat]", regex.toString())
        assertTrue(regex.containsMatchIn("cat"))
        assertTrue(regex.containsMatchIn("tiger"))
        assertTrue(regex.containsMatchIn("Ant"))
        assertTrue(regex.containsMatchIn("CAT"))
        assertTrue(regex.containsMatchIn("                A"))
        assertFalse(regex.containsMatchIn("dog"))
        assertFalse(regex.containsMatchIn(" "))
        assertFalse(regex.containsMatchIn(""))

        assertTrue(regex.containsMatchIn(BOTH_CASE_ALPHABET))
        assertTrue(regex.containsMatchIn(UPPER_CASE_ALPHABET))
        assertTrue(regex.containsMatchIn(LOWER_CASE_ALPHABET))
        assertFalse(regex.containsMatchIn(DECIMAL_DIGITS))
        assertTrue(regex.containsMatchIn(BOTH_CASE_HEX_DIGITS))
        assertTrue(regex.containsMatchIn(UPPER_CASE_HEX_DIGITS))
        assertTrue(regex.containsMatchIn(LOWER_CASE_HEX_DIGITS))
        assertFalse(regex.containsMatchIn(SYMBOLS))
        assertFalse(regex.containsMatchIn(WHITE_SPACE))
        assertFalse(regex.containsMatchIn(CONTROL_CHARACTERS))
        assertFalse(regex.containsMatchIn(EMPTY))
        assertTrue(regex.containsMatchIn(SIMPLE_NAME))
        assertTrue(regex.containsMatchIn(SIMPLE_EMAIL_ADDRESS))
        assertTrue(regex.containsMatchIn(SIMPLE_HTTP_URL))
        assertTrue(regex.containsMatchIn(SIMPLE_HTTPS_URL))
        assertFalse(regex.containsMatchIn(IPV4_ADDRESS))
        assertTrue(regex.containsMatchIn(IPV6_ADDRESS))
        assertTrue(regex.containsMatchIn(MAC_ADDRESS))
    }

    @Test
    fun testEmailAddress() {
        // Very basic e-mail address checker!
        val regex = RegexBuilder()
            .startOfString()
            .nonWhitespace(AtLeast(2))
            .text("@")
            .nonWhitespace(AtLeast(2))
            .text(".")
            .nonWhitespace(AtLeast(2))
            .endOfString()
            .buildRegex()

        assertEquals("^\\S{2,}@\\S{2,}\\.\\S{2,}$", regex.toString())
        assertTrue(regex.containsMatchIn("test.user@mainwave.co.uk"))
        assertTrue(regex.containsMatchIn("aa@bb.cc"))
        assertTrue(regex.containsMatchIn("__@__.__"))
        assertTrue(regex.containsMatchIn("..@....."))
        assertFalse(regex.containsMatchIn("aa@bb.c"))
        assertFalse(regex.containsMatchIn("aa@b.cc"))
        assertFalse(regex.containsMatchIn("a@bb.cc"))
        assertFalse(regex.containsMatchIn("a@b.c"))
        assertFalse(regex.containsMatchIn("  @  .  "))

        assertFalse(regex.containsMatchIn(BOTH_CASE_ALPHABET))
        assertFalse(regex.containsMatchIn(UPPER_CASE_ALPHABET))
        assertFalse(regex.containsMatchIn(LOWER_CASE_ALPHABET))
        assertFalse(regex.containsMatchIn(DECIMAL_DIGITS))
        assertFalse(regex.containsMatchIn(BOTH_CASE_HEX_DIGITS))
        assertFalse(regex.containsMatchIn(UPPER_CASE_HEX_DIGITS))
        assertFalse(regex.containsMatchIn(LOWER_CASE_HEX_DIGITS))
        assertTrue(regex.containsMatchIn(SYMBOLS))
        assertFalse(regex.containsMatchIn(WHITE_SPACE))
        assertFalse(regex.containsMatchIn(CONTROL_CHARACTERS))
        assertFalse(regex.containsMatchIn(EMPTY))
        assertFalse(regex.containsMatchIn(SIMPLE_NAME))
        assertTrue(regex.containsMatchIn(SIMPLE_EMAIL_ADDRESS))
        assertFalse(regex.containsMatchIn(SIMPLE_HTTP_URL))
        assertFalse(regex.containsMatchIn(SIMPLE_HTTPS_URL))
        assertFalse(regex.containsMatchIn(IPV4_ADDRESS))
        assertFalse(regex.containsMatchIn(IPV6_ADDRESS))
        assertFalse(regex.containsMatchIn(MAC_ADDRESS))
    }

    @Test
    fun testUrl() {
        // Very basic URL checker!
        val regex = RegexBuilder()
            .text("http")
            .text("s", ZeroOrOne)
            .text("://")
            .nonWhitespace(OneOrMore)
            .anyCharacterFrom("a-zA-Z0-9_/") // Valid last characters
            .buildRegex()

        assertEquals("http(?:s)?://\\S+[a-zA-Z0-9_/]", regex.toString())
        assertTrue(regex.containsMatchIn("http://www.mainwave.co.uk"))
        assertTrue(regex.containsMatchIn("https://www.mainwave.co.uk"))
        assertFalse(regex.containsMatchIn("www.mainwave.co.uk"))
        assertFalse(regex.containsMatchIn("ftp://www.mainwave.co.uk"))

        var match = regex.find("Go to http://www.mainwave.co.uk. Then click the link.")
        assertNotNull(match)
        assertEquals("http://www.mainwave.co.uk", match!!.value)

        match = regex.find("Go to https://www.mainwave.co.uk/test/, then click the link.")
        assertNotNull(match)
        assertEquals("https://www.mainwave.co.uk/test/", match!!.value)

        match = regex.find("Go to 'http://www.mainwave.co.uk' then click the link.")
        assertNotNull(match)
        assertEquals("http://www.mainwave.co.uk", match!!.value)

        match = regex.find("Go to \"http://www.mainwave.co.uk\" then click the link.")
        assertNotNull(match)
        assertEquals("http://www.mainwave.co.uk", match!!.value)

        assertFalse(regex.containsMatchIn(BOTH_CASE_ALPHABET))
        assertFalse(regex.containsMatchIn(UPPER_CASE_ALPHABET))
        assertFalse(regex.containsMatchIn(LOWER_CASE_ALPHABET))
        assertFalse(regex.containsMatchIn(DECIMAL_DIGITS))
        assertFalse(regex.containsMatchIn(BOTH_CASE_HEX_DIGITS))
        assertFalse(regex.containsMatchIn(UPPER_CASE_HEX_DIGITS))
        assertFalse(regex.containsMatchIn(LOWER_CASE_HEX_DIGITS))
        assertFalse(regex.containsMatchIn(SYMBOLS))
        assertFalse(regex.containsMatchIn(WHITE_SPACE))
        assertFalse(regex.containsMatchIn(CONTROL_CHARACTERS))
        assertFalse(regex.containsMatchIn(EMPTY))
        assertFalse(regex.containsMatchIn(SIMPLE_NAME))
        assertFalse(regex.containsMatchIn(SIMPLE_EMAIL_ADDRESS))
        assertTrue(regex.containsMatchIn(SIMPLE_HTTP_URL))
        assertTrue(regex.containsMatchIn(SIMPLE_HTTPS_URL))
        assertFalse(regex.containsMatchIn(IPV4_ADDRESS))
        assertFalse(regex.containsMatchIn(IPV6_ADDRESS))
        assertFalse(regex.containsMatchIn(MAC_ADDRESS))
    }

    @Test
    fun testIp4Address() {
        // Very basic IPv4 address checker!
        // (doesn't check values are in range, for example)
        val regex = RegexBuilder()
            .startOfString()
            .startGroup()
            .digit(Between(1, 3))
            .text(".")
            .endGroup(Exactly(3))
            .digit(Between(1, 3))
            .endOfString()
            .buildRegex()

        assertEquals("^(\\d{1,3}\\.){3}\\d{1,3}$", regex.toString())
        assertTrue(regex.containsMatchIn("10.1.1.100"))
        assertTrue(regex.containsMatchIn("1.1.1.1"))
        assertTrue(regex.containsMatchIn("0.0.0.0"))
        assertTrue(regex.containsMatchIn("255.255.255.255"))
        assertTrue(regex.containsMatchIn("999.999.999.999"))
        assertFalse(regex.containsMatchIn("1.1.1."))
        assertFalse(regex.containsMatchIn("1.1.1."))
        assertFalse(regex.containsMatchIn("1.1.1.1."))
        assertFalse(regex.containsMatchIn("1.1.1.1.1"))
        assertFalse(regex.containsMatchIn("1.1.1.1000"))

        assertFalse(regex.containsMatchIn(BOTH_CASE_ALPHABET))
        assertFalse(regex.containsMatchIn(UPPER_CASE_ALPHABET))
        assertFalse(regex.containsMatchIn(LOWER_CASE_ALPHABET))
        assertFalse(regex.containsMatchIn(DECIMAL_DIGITS))
        assertFalse(regex.containsMatchIn(BOTH_CASE_HEX_DIGITS))
        assertFalse(regex.containsMatchIn(UPPER_CASE_HEX_DIGITS))
        assertFalse(regex.containsMatchIn(LOWER_CASE_HEX_DIGITS))
        assertFalse(regex.containsMatchIn(SYMBOLS))
        assertFalse(regex.containsMatchIn(WHITE_SPACE))
        assertFalse(regex.containsMatchIn(CONTROL_CHARACTERS))
        assertFalse(regex.containsMatchIn(EMPTY))
        assertFalse(regex.containsMatchIn(SIMPLE_NAME))
        assertFalse(regex.containsMatchIn(SIMPLE_EMAIL_ADDRESS))
        assertFalse(regex.containsMatchIn(SIMPLE_HTTP_URL))
        assertFalse(regex.containsMatchIn(SIMPLE_HTTPS_URL))
        assertTrue(regex.containsMatchIn(IPV4_ADDRESS))
        assertFalse(regex.containsMatchIn(IPV6_ADDRESS))
        assertFalse(regex.containsMatchIn(MAC_ADDRESS))
    }

    @Test(expected = RegexBuilderException::class)
    fun testExceptionGroupMismatch1() {
        RegexBuilder()
            .endGroup()
            .buildRegex()
    }

    @Test(expected = RegexBuilderException::class)
    fun testExceptionGroupMismatch2() {
        RegexBuilder()
            .startGroup()
            .buildRegex()
    }

    @Test(expected = RegexBuilderException::class)
    fun testExceptionGroupMismatch3() {
        RegexBuilder()
            .startGroup()
            .startGroup()
            .endGroup()
            .buildRegex()
    }

    @Test
    fun testZeroOrMoreButAsFewAsPossible() {
        val regex = RegexBuilder()
            .digit(ZeroOrMore.butAsFewAsPossible)
            .buildRegex()

        assertEquals("\\d*?", regex.toString())
        val nonGreedyMatch = regex.find("999")
        assertNotNull(nonGreedyMatch)
        assertEquals("", nonGreedyMatch!!.value)

        assertTrue(regex.containsMatchIn(BOTH_CASE_ALPHABET))
        assertTrue(regex.containsMatchIn(UPPER_CASE_ALPHABET))
        assertTrue(regex.containsMatchIn(LOWER_CASE_ALPHABET))
        assertTrue(regex.containsMatchIn(DECIMAL_DIGITS))
        assertTrue(regex.containsMatchIn(BOTH_CASE_HEX_DIGITS))
        assertTrue(regex.containsMatchIn(UPPER_CASE_HEX_DIGITS))
        assertTrue(regex.containsMatchIn(LOWER_CASE_HEX_DIGITS))
        assertTrue(regex.containsMatchIn(SYMBOLS))
        assertTrue(regex.containsMatchIn(WHITE_SPACE))
        assertTrue(regex.containsMatchIn(CONTROL_CHARACTERS))
        assertTrue(regex.containsMatchIn(EMPTY))
        assertTrue(regex.containsMatchIn(SIMPLE_NAME))
        assertTrue(regex.containsMatchIn(SIMPLE_EMAIL_ADDRESS))
        assertTrue(regex.containsMatchIn(SIMPLE_HTTP_URL))
        assertTrue(regex.containsMatchIn(SIMPLE_HTTPS_URL))
        assertTrue(regex.containsMatchIn(IPV4_ADDRESS))
        assertTrue(regex.containsMatchIn(IPV6_ADDRESS))
        assertTrue(regex.containsMatchIn(MAC_ADDRESS))
    }

    @Test
    fun testOneOrMoreButAsFewAsPossible() {
        val regex = RegexBuilder()
            .digit(OneOrMore.butAsFewAsPossible)
            .buildRegex()

        assertEquals("\\d+?", regex.toString())
        val nonGreedyMatch = regex.find("999")
        assertNotNull(nonGreedyMatch)
        assertEquals("9", nonGreedyMatch!!.value)

        assertFalse(regex.containsMatchIn(BOTH_CASE_ALPHABET))
        assertFalse(regex.containsMatchIn(UPPER_CASE_ALPHABET))
        assertFalse(regex.containsMatchIn(LOWER_CASE_ALPHABET))
        assertTrue(regex.containsMatchIn(DECIMAL_DIGITS))
        assertTrue(regex.containsMatchIn(BOTH_CASE_HEX_DIGITS))
        assertTrue(regex.containsMatchIn(UPPER_CASE_HEX_DIGITS))
        assertTrue(regex.containsMatchIn(LOWER_CASE_HEX_DIGITS))
        assertFalse(regex.containsMatchIn(SYMBOLS))
        assertFalse(regex.containsMatchIn(WHITE_SPACE))
        assertFalse(regex.containsMatchIn(CONTROL_CHARACTERS))
        assertFalse(regex.containsMatchIn(EMPTY))
        assertFalse(regex.containsMatchIn(SIMPLE_NAME))
        assertFalse(regex.containsMatchIn(SIMPLE_EMAIL_ADDRESS))
        assertFalse(regex.containsMatchIn(SIMPLE_HTTP_URL))
        assertFalse(regex.containsMatchIn(SIMPLE_HTTPS_URL))
        assertTrue(regex.containsMatchIn(IPV4_ADDRESS))
        assertTrue(regex.containsMatchIn(IPV6_ADDRESS))
        assertTrue(regex.containsMatchIn(MAC_ADDRESS))
    }

    @Test
    fun testAtLeastButAsFewAsPossible() {
        val regex = RegexBuilder()
            .digit(AtLeast(1).butAsFewAsPossible)
            .buildRegex()

        assertEquals("\\d{1,}?", regex.toString())
        val nonGreedyMatch = regex.find("999")
        assertNotNull(nonGreedyMatch)
        assertEquals("9", nonGreedyMatch!!.value)

        assertFalse(regex.containsMatchIn(BOTH_CASE_ALPHABET))
        assertFalse(regex.containsMatchIn(UPPER_CASE_ALPHABET))
        assertFalse(regex.containsMatchIn(LOWER_CASE_ALPHABET))
        assertTrue(regex.containsMatchIn(DECIMAL_DIGITS))
        assertTrue(regex.containsMatchIn(BOTH_CASE_HEX_DIGITS))
        assertTrue(regex.containsMatchIn(UPPER_CASE_HEX_DIGITS))
        assertTrue(regex.containsMatchIn(LOWER_CASE_HEX_DIGITS))
        assertFalse(regex.containsMatchIn(SYMBOLS))
        assertFalse(regex.containsMatchIn(WHITE_SPACE))
        assertFalse(regex.containsMatchIn(CONTROL_CHARACTERS))
        assertFalse(regex.containsMatchIn(EMPTY))
        assertFalse(regex.containsMatchIn(SIMPLE_NAME))
        assertFalse(regex.containsMatchIn(SIMPLE_EMAIL_ADDRESS))
        assertFalse(regex.containsMatchIn(SIMPLE_HTTP_URL))
        assertFalse(regex.containsMatchIn(SIMPLE_HTTPS_URL))
        assertTrue(regex.containsMatchIn(IPV4_ADDRESS))
        assertTrue(regex.containsMatchIn(IPV6_ADDRESS))
        assertTrue(regex.containsMatchIn(MAC_ADDRESS))
    }

    @Test
    fun testBetweenButAsFewAsPossible() {
        val regex = RegexBuilder()
            .digit(Between(2, 100).butAsFewAsPossible)
            .buildRegex()

        assertEquals("\\d{2,100}?", regex.toString())
        val nonGreedyMatch = regex.find("999")
        assertNotNull(nonGreedyMatch)
        assertEquals("99", nonGreedyMatch!!.value)

        assertFalse(regex.containsMatchIn(BOTH_CASE_ALPHABET))
        assertFalse(regex.containsMatchIn(UPPER_CASE_ALPHABET))
        assertFalse(regex.containsMatchIn(LOWER_CASE_ALPHABET))
        assertTrue(regex.containsMatchIn(DECIMAL_DIGITS))
        assertTrue(regex.containsMatchIn(BOTH_CASE_HEX_DIGITS))
        assertTrue(regex.containsMatchIn(UPPER_CASE_HEX_DIGITS))
        assertTrue(regex.containsMatchIn(LOWER_CASE_HEX_DIGITS))
        assertFalse(regex.containsMatchIn(SYMBOLS))
        assertFalse(regex.containsMatchIn(WHITE_SPACE))
        assertFalse(regex.containsMatchIn(CONTROL_CHARACTERS))
        assertFalse(regex.containsMatchIn(EMPTY))
        assertFalse(regex.containsMatchIn(SIMPLE_NAME))
        assertFalse(regex.containsMatchIn(SIMPLE_EMAIL_ADDRESS))
        assertFalse(regex.containsMatchIn(SIMPLE_HTTP_URL))
        assertFalse(regex.containsMatchIn(SIMPLE_HTTPS_URL))
        assertTrue(regex.containsMatchIn(IPV4_ADDRESS))
        assertTrue(regex.containsMatchIn(IPV6_ADDRESS))
        assertTrue(regex.containsMatchIn(MAC_ADDRESS))
    }

    @Test
    fun testNoMoreThanButAsFewAsPossible() {
        val regex = RegexBuilder()
            .digit(NoMoreThan(2).butAsFewAsPossible)
            .buildRegex()

        assertEquals("\\d{0,2}?", regex.toString())
        val nonGreedyMatch = regex.find("999")
        assertNotNull(nonGreedyMatch)
        assertEquals("", nonGreedyMatch!!.value)

        assertTrue(regex.containsMatchIn(BOTH_CASE_ALPHABET))
        assertTrue(regex.containsMatchIn(UPPER_CASE_ALPHABET))
        assertTrue(regex.containsMatchIn(LOWER_CASE_ALPHABET))
        assertTrue(regex.containsMatchIn(DECIMAL_DIGITS))
        assertTrue(regex.containsMatchIn(BOTH_CASE_HEX_DIGITS))
        assertTrue(regex.containsMatchIn(UPPER_CASE_HEX_DIGITS))
        assertTrue(regex.containsMatchIn(LOWER_CASE_HEX_DIGITS))
        assertTrue(regex.containsMatchIn(SYMBOLS))
        assertTrue(regex.containsMatchIn(WHITE_SPACE))
        assertTrue(regex.containsMatchIn(CONTROL_CHARACTERS))
        assertTrue(regex.containsMatchIn(EMPTY))
        assertTrue(regex.containsMatchIn(SIMPLE_NAME))
        assertTrue(regex.containsMatchIn(SIMPLE_EMAIL_ADDRESS))
        assertTrue(regex.containsMatchIn(SIMPLE_HTTP_URL))
        assertTrue(regex.containsMatchIn(SIMPLE_HTTPS_URL))
        assertTrue(regex.containsMatchIn(IPV4_ADDRESS))
        assertTrue(regex.containsMatchIn(IPV6_ADDRESS))
        assertTrue(regex.containsMatchIn(MAC_ADDRESS))
    }

    @Test
    fun testZeroOrOneButAsFewAsPossible() {
        val regex = RegexBuilder()
            .digit(ZeroOrOne.butAsFewAsPossible)
            .buildRegex()

        assertEquals("\\d??", regex.toString())
        val nonGreedyMatch = regex.find("999")
        assertNotNull(nonGreedyMatch)
        assertEquals("", nonGreedyMatch!!.value)

        assertTrue(regex.containsMatchIn(BOTH_CASE_ALPHABET))
        assertTrue(regex.containsMatchIn(UPPER_CASE_ALPHABET))
        assertTrue(regex.containsMatchIn(LOWER_CASE_ALPHABET))
        assertTrue(regex.containsMatchIn(DECIMAL_DIGITS))
        assertTrue(regex.containsMatchIn(BOTH_CASE_HEX_DIGITS))
        assertTrue(regex.containsMatchIn(UPPER_CASE_HEX_DIGITS))
        assertTrue(regex.containsMatchIn(LOWER_CASE_HEX_DIGITS))
        assertTrue(regex.containsMatchIn(SYMBOLS))
        assertTrue(regex.containsMatchIn(WHITE_SPACE))
        assertTrue(regex.containsMatchIn(CONTROL_CHARACTERS))
        assertTrue(regex.containsMatchIn(EMPTY))
        assertTrue(regex.containsMatchIn(SIMPLE_NAME))
        assertTrue(regex.containsMatchIn(SIMPLE_EMAIL_ADDRESS))
        assertTrue(regex.containsMatchIn(SIMPLE_HTTP_URL))
        assertTrue(regex.containsMatchIn(SIMPLE_HTTPS_URL))
        assertTrue(regex.containsMatchIn(IPV4_ADDRESS))
        assertTrue(regex.containsMatchIn(IPV6_ADDRESS))
        assertTrue(regex.containsMatchIn(MAC_ADDRESS))
    }
}